<html><head><title>全文文本(Fulltext)</title><meta http-equiv='Content-Type' content='text/html; charset=UTF-8'><style>div.fullText table {width: 100%;text-indent: 1px;} 
 div.fullText table td.header {font-weight: bold;text-align: center;font-family: '宋体';font-size: 16px;line-height:20px;color: #000000;padding: 5px;}div.fullText table td.content {padding: 1px;text-align: left;vertical-align: top;width: 100%;font-family: '宋体';font-size: 14px;line-height:20px;color: #000000;}</style></head><body><?xml version="1.0" encoding="UTF-8"?><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" class="fullText"><table class="fullText"><tr><td id="claim_title" class="header">权利要求书</td></tr><tr><td class="content" id="claim_1">1、一种在线下发授权信息的方法，其特征在于：
      <br/>
				</td></tr><tr><td class="content" id="claim_2">该方法用于向条件接收CA终端下发授权信息，所述CA终端包括移动终
      <br/>端和卡，所述移动终端和卡通过通用接口相连；
      <br/>
				</td></tr><tr><td class="content" id="claim_3">该方法包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_4">A、CA系统对授权信息进行签名得到授权信息的签名信息，并将所述授权
      <br/>信息的签名信息、以及所述授权信息下发给所述移动终端；
      <br/>
				</td></tr><tr><td class="content" id="claim_5">B、所述移动终端将所述授权信息的签名信息、以及所述授权信息发送给
      <br/>所述卡；
      <br/>
				</td></tr><tr><td class="content" id="claim_6">C、所述卡对所述授权信息的签名信息进行验证，验证成功通过后，将所
      <br/>述授权信息保存在卡的安全区内。
      <br/>
				</td></tr><tr><td class="content" id="claim_7">2、根据权利要求1所述的方法，其特征在于，所述卡为智能存储卡；
      <br/>
				</td></tr><tr><td class="content" id="claim_8">所述步骤C之后进一步包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_9">D、移动终端将条件接收信息发送给所述智能存储卡；
      <br/>
				</td></tr><tr><td class="content" id="claim_10">E、所述智能存储卡根据所述条件接收信息以及授权信息解密得到CW，根
      <br/>据CW对加扰的多媒体数据进行解扰，并将解扰得到的多媒体数据发送给所述
      <br/>移动终端。
      <br/>
				</td></tr><tr><td class="content" id="claim_11">3、根据权利要求2所述的方法，其特征在于，在所述步骤D与E之间进
      <br/>一步包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_12">F、所述智能存储卡根据所述条件接收信息对业务进行鉴权，若鉴权成功通
      <br/>过，则继续执行步骤E。
      <br/>
				</td></tr><tr><td class="content" id="claim_13">4、根据权利要求3所述的方法，其特征在于，所述步骤F包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_14">F1、判断与所述条件接收信息对应的权限文件是否存在，若存在，则执行
      <br/>步骤F2，否则，跳到步骤F5；
      <br/>
				</td></tr><tr><td class="content" id="claim_15">F2、根据所述权限文件中的权限描述判断是否存在包月模式权限，若存在，
      <br/>则继续执行步骤F3，否则，跳到步骤F4；
      <br/>
					
				</td></tr><tr><td class="content" id="claim_16">F3、判断当前时间是否超过所述包月模式的过期时间，若未超过，则鉴权
      <br/>成功通过，否则，跳到步骤F6；
      <br/>
				</td></tr><tr><td class="content" id="claim_17">F4、根据所述权限文件中的权限描述判断是否存在观看次数模式权限，若
      <br/>存在，执行步骤F5；
      <br/>
				</td></tr><tr><td class="content" id="claim_18">F5、判断剩余观看次数是否为0，若不为0，则将剩余观看次数减一，并生
      <br/>成过期时间权限文件，鉴权成功通过；若为0，则执行步骤F6；
      <br/>
				</td></tr><tr><td class="content" id="claim_19">F6、判断点数权限文件是否存在，若存在，则在点数权限文件中扣除相应
      <br/>的点数，生成过期时间权限文件，鉴权成功通过，若不存在，则判断是否支持
      <br/>后付费模式，若支持，则生成后付费权限文件，鉴权成功通过，否则鉴权失败。
      <br/>
				</td></tr><tr><td class="content" id="claim_20">5、根据权利要求4所述的方法，其特征在于：
      <br/>
				</td></tr><tr><td class="content" id="claim_21">步骤F1中判断与所述条件接收信息对应的权限文件是否存在的依据为：根
      <br/>据条件接收信息对应的业务标识以及所述权限文件对应的业务标识是否相同进
      <br/>行判断。
      <br/>
				</td></tr><tr><td class="content" id="claim_22">6、一种在线下发授权信息的系统，其特征在于，该系统包括：条件接收
      <br/>CA系统和CA终端；
      <br/>
				</td></tr><tr><td class="content" id="claim_23">所述CA终端包括移动终端和卡，所述移动终端通过其接口模块与卡相连；
      <br/>
				</td></tr><tr><td class="content" id="claim_24">所述CA系统，用于对授权信息进行签名得到授权信息的签名信息，并将
      <br/>所述授权信息的签名信息、以及所述授权信息下发给所述移动终端；
      <br/>
				</td></tr><tr><td class="content" id="claim_25">所述移动终端，用于通过所述接口模块将所述授权信息的签名信息、以及
      <br/>所述授权信息发送给所述卡；
      <br/>
				</td></tr><tr><td class="content" id="claim_26">所述卡，用于对所述授权信息的签名信息进行验证，在验证成功通过时，
      <br/>用于将所述授权信息保存在卡的安全区内。
      <br/>
				</td></tr><tr><td class="content" id="claim_27">7、根据权利要求6所述的系统，其特征在于：
      <br/>
				</td></tr><tr><td class="content" id="claim_28">所述卡为智能存储卡；
      <br/>
				</td></tr><tr><td class="content" id="claim_29">所述移动终端，还用于将条件接收信息发送给所述智能存储卡；
      <br/>
				</td></tr><tr><td class="content" id="claim_30">所述智能存储卡，还用于根据所述条件接收信息以及授权信息解密得到
      <br/>CW，根据CW对加扰的多媒体数据进行解扰，并将解扰得到的多媒体数据发
      <br/>
					送给所述移动终端。
      <br/>
				</td></tr><tr><td class="content" id="claim_31">8、根据权利要求7所述的系统，其特征在于，所述智能存储卡中包含权限
      <br/>控制模块；
      <br/>
				</td></tr><tr><td class="content" id="claim_32">所述权限控制模块，用于根据条件接收信息对业务进行鉴权。
      <br/>
				</td></tr><tr><td class="content" id="claim_33">9、根据权利要求8所述的系统，其特征在于：
      <br/>
				</td></tr><tr><td class="content" id="claim_34">所述权限控制模块在鉴权过程中，首先判断与所述条件接收信息对应的权
      <br/>限文件是否存在，在与条件接收信息对应的权限文件不存在时，继续判断点数
      <br/>权限文件是否存在；在与条件接收信息对应的权限文件存在时，继续根据所述
      <br/>权限文件中的权限描述判断是否存在包月模式权限，在存在包月模式权限时，
      <br/>继续判断当前时间是否超过所述包月模式的过期时间，若未超过，则判定鉴权
      <br/>成功通过，否则，继续判断点数权限文件是否存在，在不存在包月模式权限时，
      <br/>继续判断是否存在观看次数模式权限，在存在观看次数权限、且剩余观看次数
      <br/>不为0时，将剩余观看次数减一，并生成过期时间权限文件，判定鉴权成功通
      <br/>过，在剩余观看次数为0时，继续判断点数权限文件是否存在；在点数权限文
      <br/>件存在时，在点数权限文件中扣除相应的点数，生成过期时间权限文件，判定
      <br/>鉴权成功通过，在点数权限文件不存在时，判断是否支持后付费模式，在支持
      <br/>时，生成后付费权限文件，判定鉴权成功通过，在不支持时，判定鉴权失败。
      <br/>
				</td></tr><tr><td class="content" id="claim_35">10、根据权利要求9所述的系统，其特征在于：
      <br/>
				</td></tr><tr><td class="content" id="claim_36">所述权限控制模块，用于根据条件接收信息对应的业务标识以及所述权限
      <br/>文件对应的业务标识是否相同判断与所述条件接收信息对应的权限文件是否存
      <br/>在。
      <br/>
					
				</td></tr></table></div><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" class="fullText"><table><tr><td id="description_title" class="header">说明书</td></tr><tr><td class="content" id="description_invention_title">一种在线下发授权信息的方法及系统
  </td></tr><tr><td class="content" id="description_1">技术领域
  </td></tr><tr><td class="content" id="description_2">本发明涉及移动多媒体广播技术，特别涉及一种在线下发授权信息的方
    法及系统。
    
				</td></tr><tr><td class="content" id="description_3">背景技术
  </td></tr><tr><td class="content" id="description_4">在移动多媒体广播系统中，多媒体节目以广播的形式下发给各移动终
    端。对于计费的多媒体节目，为了保障业务提供商的利益，要求移动终端具
    备条件接收功能，即：计费的多媒体节目数据被CA系统加扰之后传输，移
    动终端需先成功解扰多媒体节目数据，才能正常收看。
    
				</td></tr><tr><td class="content" id="description_5">具体而言，实现条件接收的过程是：多路加扰后的多媒体节目数据及其
    相应的条件接收信息被复用到信道中传输，移动终端接收到数据后先由解复
    用器对其进行解复用，然后由解扰器根据条件接收信息及终端侧存储的授权
    信息对加扰后的多媒体节目数据进行解扰，得到多媒体节目数据，并播放。
    
				</td></tr><tr><td class="content" id="description_6">现有技术中存在两种终端侧条件接收实现方案：一种是无卡方案，另一
    种是有卡方案。下面分别予以介绍：
    
				</td></tr><tr><td class="content" id="description_7">1、无卡方案
    
				</td></tr><tr><td class="content" id="description_8">该方案完全由移动终端进行CW的解密以及加密信息的解扰，具体实现
    方式是：通过移动终端内置一颗解扰芯片，完成CW的解密以及加密信息的
    解扰。
    
				</td></tr><tr><td class="content" id="description_9">该方案的缺点是现有大部分移动终端不支持，必须重新提供移动终端设
    备，这样，广电运营商、移动终端生产厂家成本提高，又会转嫁到最终用户
    身上，该方案不利于普及。并且，移动终端必须经过认证，能够提供可信的
    运行环境，导致移动终端的成本较高。
    
				</td></tr><tr><td class="content" id="description_10">2、有卡方案
    
				</td></tr><tr><td class="content" id="description_11">该方案下，存在两种不同的实现方式：
    
				</td></tr><tr><td class="content" id="description_12">1)第一种实现方式：基于智能卡实现。解扰器位于移动终端内部，解
    扰器与智能卡之间通过ISO7816接口相连，智能卡负责根据授权信息和条件
    接收信息解密得到控制字(CW)，并将CW传送给移动终端的解扰器，移
    动终端中的解扰器利用CW对加扰的内容进行解扰并播放。
    
				</td></tr><tr><td class="content" id="description_13">该方案的缺点是要求移动终端必须经过认证，能够提供可信的运行环
    境，移动终端成本较高，也无法实现机卡分离；而且该方案中CW出卡，比
    较容易被破解。
    
				</td></tr><tr><td class="content" id="description_14">2)第二种实现方式：基于智能存储卡实现。智能存储卡是一种存储卡，
    该存储卡不但具有大容量存储功能，同时具有安全及数据协处理功能。
    
				</td></tr><tr><td class="content" id="description_15">解扰器位于智能存储卡中，智能存储卡负责根据授权信息和条件接收信
    息解密得到CW，并利用CW对加扰的内容进行解扰，然后将解扰得到的数
    据发送给移动终端进行播放。
    
				</td></tr><tr><td class="content" id="description_16">由于该方案中，条件接收功能完全由智能存储卡实现，因此，通常称之
    为机卡分离方案。该方案中，由于解扰处理在卡内完成，所有密钥都不出卡，
    提高了条件接收的安全性；同时条件接收只是与卡绑定，与移动终端无关，
    用户可以随意更换移动终端而不影响用户收看多媒体节目，便于推广普及，
    是目前最好的一种实现方案。
    
				</td></tr><tr><td class="content" id="description_17">无论上述哪一种方案，均需要使用授权信息。授权信息是指用户权限信
    息，例如：节目定购、充值、缴费方式改变等等。授权信息有两种下发方式：
    一种是离线方式，另一种是在线方式。
    
				</td></tr><tr><td class="content" id="description_18">离线方式是用户必须到运营商指定地点去办理，这种实现方式要求运营
    商提供多个营业地点，而且用户必须到营业地点去下载授权信息。这种方式
    给运营商、用户都带来不便利性，不利于普及。
    
				</td></tr><tr><td class="content" id="description_19">在线方式是将授权信息通过广播通道直接下发到移动终端，用户通过移
    动终端就可以接收。
    
				</td></tr><tr><td class="content" id="description_20">现有的在线方式通常是授权信息被CA系统以密文方式下发到移动终
    端。一方面，终端侧的计算资源非常有限，而对授权信息的解密通常需要进
    行大量运算，导致终端侧的运算负荷较大；另一方面，虽然对授权信息进行
    了加密，但仍然存在密文可能被解密，进而授权信息被篡改的风险。比如，
    移动终端有可能不按照规定的流程进行开发。
    
				</td></tr><tr><td class="content" id="description_21">此外，由于移动终端必须能够提供可信的运行环境，导致移动终端成本
    较高；否则，若移动终端无法提供可行的运行环境，则授权信息很容易被破
    解。
    
				</td></tr><tr><td class="content" id="description_22">发明内容
  </td></tr><tr><td class="content" id="description_23">有鉴于此，本发明的主要目的在于提供一种在线下发授权信息的方法及
    系统，以保证授权信息的安全性，并降低终端侧的运算负荷。
    
				</td></tr><tr><td class="content" id="description_24">为达到上述目的，本发明的技术方案具体是这样实现的：
    
				</td></tr><tr><td class="content" id="description_25">一种在线下发授权信息的方法，该方法用于向条件接收CA终端下发授
    权信息，所述CA终端包括移动终端和卡，所述移动终端和卡通过通用接口
    相连；
    
				</td></tr><tr><td class="content" id="description_26">该方法包括：
    
				</td></tr><tr><td class="content" id="description_27">A、CA系统对授权信息进行签名得到授权信息的签名信息，并将所述
    授权信息的签名信息、以及所述授权信息下发给所述移动终端；
    
				</td></tr><tr><td class="content" id="description_28">B、所述移动终端将所述授权信息的签名信息、以及所述授权信息发送
    给所述卡；
    
				</td></tr><tr><td class="content" id="description_29">C、所述卡对所述授权信息的签名信息进行验证，验证成功通过后，将
    所述授权信息保存在卡的安全区内。
    
				</td></tr><tr><td class="content" id="description_30">较佳地，所述卡可以为智能存储卡；
    
				</td></tr><tr><td class="content" id="description_31">所述步骤C之后可以进一步包括：
    
				</td></tr><tr><td class="content" id="description_32">D、移动终端将条件接收信息发送给所述智能存储卡；
    
				</td></tr><tr><td class="content" id="description_33">E、所述智能存储卡根据所述条件接收信息以及授权信息解密得到CW，
    
					根据CW对加扰的多媒体数据进行解扰，并将解扰得到的多媒体数据发送给
    所述移动终端。
    
				</td></tr><tr><td class="content" id="description_34">进一步地，在所述步骤D与E之间可以包括：
    
				</td></tr><tr><td class="content" id="description_35">F、所述智能存储卡根据所述条件接收信息对业务进行鉴权，若鉴权成
    功通过，则继续执行步骤E。
    
				</td></tr><tr><td class="content" id="description_36">较佳地，所述步骤F可以包括：
    
				</td></tr><tr><td class="content" id="description_37">F1、判断与所述条件接收信息对应的权限文件是否存在，若存在，则执
    行步骤F2，否则，跳到步骤F5；
    
				</td></tr><tr><td class="content" id="description_38">F2、根据所述权限文件中的权限描述判断是否存在包月模式权限，若存
    在，则继续执行步骤F3，否则，跳到步骤F4；
    
				</td></tr><tr><td class="content" id="description_39">F3、判断当前时间是否超过所述包月模式的过期时间，若未超过，则鉴
    权成功通过，否则，跳到步骤F6；
    
				</td></tr><tr><td class="content" id="description_40">F4、根据所述权限文件中的权限描述判断是否存在观看次数模式权限，
    若存在，执行步骤F5；
    
				</td></tr><tr><td class="content" id="description_41">F5、判断剩余观看次数是否为0，若不为0，则将剩余观看次数减一，
    并生成过期时间权限文件，鉴权成功通过；若为0，则执行步骤F6；
    
				</td></tr><tr><td class="content" id="description_42">F6、判断点数权限文件是否存在，若存在，则在点数权限文件中扣除相
    应的点数，生成过期时间权限文件，鉴权成功通过，若不存在，则判断是否
    支持后付费模式，若支持，则生成后付费权限文件，鉴权成功通过，否则鉴
    权失败。
    
				</td></tr><tr><td class="content" id="description_43">步骤F1中判断与所述条件接收信息对应的权限文件是否存在的依据可
    以为：根据条件接收信息对应的业务标识以及所述权限文件对应的业务标识
    是否相同进行判断。
    
				</td></tr><tr><td class="content" id="description_44">一种在线下发授权信息的系统，该系统包括：条件接收CA系统和CA
    终端；
    
				</td></tr><tr><td class="content" id="description_45">所述CA终端包括移动终端和卡，所述移动终端通过其接口模块与卡相
    连；
    
				</td></tr><tr><td class="content" id="description_46">所述CA系统，用于对授权信息进行签名得到授权信息的签名信息，并
    将所述授权信息的签名信息、以及所述授权信息下发给所述移动终端；
    
				</td></tr><tr><td class="content" id="description_47">所述移动终端，用于通过所述接口模块将所述授权信息的签名信息、以
    及所述授权信息发送给所述卡；
    
				</td></tr><tr><td class="content" id="description_48">所述卡，用于对所述授权信息的签名信息进行验证，在验证成功通过时，
    用于将所述授权信息保存在卡的安全区内。
    
				</td></tr><tr><td class="content" id="description_49">较佳地，所述卡可以为智能存储卡；
    
				</td></tr><tr><td class="content" id="description_50">所述移动终端，还可以用于将条件接收信息发送给所述智能存储卡；
    
				</td></tr><tr><td class="content" id="description_51">所述智能存储卡，还可以用于根据所述条件接收信息以及授权信息解密
    得到CW，根据CW对加扰的多媒体数据进行解扰，并将解扰得到的多媒体
    数据发送给所述移动终端。
    
				</td></tr><tr><td class="content" id="description_52">所述智能存储卡中还可以包含权限控制模块；
    
				</td></tr><tr><td class="content" id="description_53">所述权限控制模块，用于根据条件接收信息对业务进行鉴权。
    
				</td></tr><tr><td class="content" id="description_54">所述权限控制模块在鉴权过程中，可以首先判断与所述条件接收信息对
    应的权限文件是否存在，在与条件接收信息对应的权限文件不存在时，继续
    判断点数权限文件是否存在；在与条件接收信息对应的权限文件存在时，继
    续根据所述权限文件中的权限描述判断是否存在包月模式权限，在存在包月
    模式权限时，继续判断当前时间是否超过所述包月模式的过期时间，若未超
    过，则判定鉴权成功通过，否则，继续判断点数权限文件是否存在，在不存
    在包月模式权限时，继续判断是否存在观看次数模式权限，在存在观看次数
    权限、且剩余观看次数不为0时，将剩余观看次数减一，并生成过期时间权
    限文件，判定鉴权成功通过，在剩余观看次数为0时，继续判断点数权限文
    件是否存在；在点数权限文件存在时，在点数权限文件中扣除相应的点数，
    生成过期时间权限文件，判定鉴权成功通过，在点数权限文件不存在时，判
    断是否支持后付费模式，在支持时，生成后付费权限文件，判定鉴权成功通
    过，在不支持时，判定鉴权失败。
    
				</td></tr><tr><td class="content" id="description_55">所述权限控制模块，可以用于根据条件接收信息对应的业务标识以及所
    
					述权限文件对应的业务标识是否相同判断与所述条件接收信息对应的权限
    文件是否存在。
    
				</td></tr><tr><td class="content" id="description_56">由上述技术方案可见，本发明提供的在线下发授权信息的方法及系统，
    通过对授权信息进行签名，并将授权信息明文以及授权信息的签名信息下
    发，然后由移动终端将签名信息和授权信息明文传送给卡，最后由卡通过验
    证签名来认证授权信息的完整性。这样，能够保证授权信息在下发过程中的
    安全性。一旦授权信息被截获篡改，那么就无法通过智能存储卡的签名认证，
    从而保证了授权信息的安全性。授权信息验证通过后，将被保存在智能存储
    卡的安全区内并替换原有的已失效的授权信息。智能存储卡的安全区必须经
    过严格的身份认证才能访问，确保所存储的授权信息的安全性。此外，由于
    授权信息以明文形式下发，终端侧无需对授权信息进行解密，从而降低了终
    端的运算负荷。
    
				</td></tr><tr><td class="content" id="description_57">并且，采用本发明使得移动终端无需提供可靠的运行环境，使移动终端
    的成本得以降低。
    
				</td></tr><tr><td class="content" id="description_58">而且，采用本发明提供的下发授权信息的方法及系统向机卡分离式的
    CA终端下发授权信息，使得所有与条件接收相关的功能均由智能存储卡实
    现，所述功能包括：验证授权信息完整性、存储授权信息、解密CW、解扰
    等，从而使得用户只需拥有一张智能存储卡，即可在任意移动终端上接收移
    动多媒体广播节目，因此，实现了真正意义上的机卡分离。
    
				</td></tr><tr><td class="content" id="description_59">此外，本发明提供了一种根据授权信息进行鉴权计费的处理方法，能够
    实现鉴权计费。
    
				</td></tr><tr><td class="content" id="description_60">附图说明
  </td></tr><tr><td class="content" id="description_61">图1示出了现有针对有卡方案以在线方式下发授权信息的示意图；
    
				</td></tr><tr><td class="content" id="description_62">图2为本发明在线下发授权信息的方法的示意图；
    
				</td></tr><tr><td class="content" id="description_63">图3为本发明一较佳实现鉴权计费的流程示意图；
    
				</td></tr><tr><td class="content" id="description_64">图4为本发明在线下发授权信息的系统的组成结构示意图。
    
				</td></tr><tr><td class="content" id="description_65">具体实施方式
  </td></tr><tr><td class="content" id="description_66">为使本发明的目的、技术方案及优点更加清楚明白，以下参照附图并举
    实施例，对本发明作进一步详细说明。
    
				</td></tr><tr><td class="content" id="description_67">本发明的主要思想是将授权信息明文形式签名之后下发，然后由移动终
    端将带有签名的授权信息传送给卡，卡通过签名，来认证授权信息的完整性。
    这样，能够保证授权信息在下发过程中的安全性。一旦授权信息被截获篡改，
    那么就无法通过智能存储卡的签名认证，从而保证了授权信息的安全性。授
    权信息验证通过后，将被保存在智能存储卡的安全区内并替换原有的已失效
    的授权信息。智能存储卡的安全区必须经过严格的身份认证才能访问，确保
    所存储的授权信息的安全性。
    
				</td></tr><tr><td class="content" id="description_68">图2为本发明在线下发授权信息的方法的示意图。图2所示方法用于向
    CA终端下发授权信息，所述CA终端包括移动终端和卡，所述移动终端和
    卡通过通用接口相连。本发明图2所示方法既适用于所述卡是智能存储卡的
    情况，也适用于所述卡是智能卡的情况。
    
				</td></tr><tr><td class="content" id="description_69">参见图2，该方法包括：
    
				</td></tr><tr><td class="content" id="description_70">步骤201：CA系统对授权信息进行签名得到授权信息的签名信息，并
    将所述授权信息的签名信息、以及所述授权信息下发给所述移动终端。
    
				</td></tr><tr><td class="content" id="description_71">本步骤中，CA系统可以以授权信息的明文作为签名对象，进行签名。
    当然，如果无需考虑终端侧运算负荷的情况下，也可以先对授权信息进行加
    密，然后对所述密文进行签名。所述授权信息的密文为根据一种事先约定的、
    CA系统与智能存储卡均可获知的加密方式对授权信息进行加密之后得到，
    以便智能存储卡在对签名进行验证得到密文之后能够成功解密出授权信息。
    
				</td></tr><tr><td class="content" id="description_72">步骤202：所述移动终端将所述授权信息的签名信息、以及所述授权信
    息发送给所述卡。
    
				</td></tr><tr><td class="content" id="description_73">步骤203：所述卡对所述授权信息的签名信息进行验证，在验证成功通
    过后，将所述授权信息保存在卡的安全区内。
    
				</td></tr><tr><td class="content" id="description_74">至此，结束本发明在线下发授权信息的方法。
    
				</td></tr><tr><td class="content" id="description_75">若采用智能存储卡实现上述方案，那么，移动终端可以将条件接收信息
    发送给智能存储卡，在智能存储卡确认授权信息安全之后，由智能存储卡根
    据所述条件接收信息以及授权信息解密得到CW，并根据CW对加扰的多媒
    体数据进行解扰，最后将解扰得到的多媒体数据发送给所述移动终端。
    
				</td></tr><tr><td class="content" id="description_76">下面以针对一个用户下发授权信息为例，说明本发明的具体实施方式：
    
				</td></tr><tr><td class="content" id="description_77">运营商有一对密钥：公钥和私钥，运营商将公钥存储在智能存储卡中，
    发给合法用户。运营商用自己的私钥对授权信息进行签名处理，通过广播通
    道下发到用户的移动终端，移动终端将带签名的授权信息发送给智能存储
    卡。智能存储卡利用内部存储的公钥对该签名授权信息进行完整性校验，如
    果认证通过，认为该授权信息安全、完整，可以将授权信息写入卡内；如果
    认证失败，就不对该信息进行处理，。
    
				</td></tr><tr><td class="content" id="description_78">在上述技术方案的基础上，为实现计费，可以引入业务鉴权过程。具体
    而言，就是在智能存储卡接收到移动终端的条件接收信息和CW解密请求之
    后，根据所述条件接收信息对业务进行鉴权，在鉴权成功通过之后，再执行
    所述解密得到CW，根据CW对加扰的多媒体数据进行解扰的操作。
    
				</td></tr><tr><td class="content" id="description_79">在具体实现时，可以采取多种计费模式，例如：包月模式、观看次数模
    式、预付费模式和后付费模式等，以下通过一个示例进行说明。
    
				</td></tr><tr><td class="content" id="description_80">图3为本发明一较佳实现鉴权计费的流程示意图。参见图3，该流程包
    括：
    
				</td></tr><tr><td class="content" id="description_81">步骤301：判断与条件接收信息对应的权限文件是否存在，若存在，则
    执行步骤302，否则，跳到步骤306。
    
				</td></tr><tr><td class="content" id="description_82">本步骤所述条件接收信息包括：授权控制消息(ECM，Entitlement Control
    Message)和授权管理消息(EMM，Entitlement Management Message)等。
    由于ECM和EMM信息中均包含其对应的业务标识信息，权限文件中也包
    含与其对应的业务标识信息，因此，在判断与条件接收信息对应的权限文件
    是否存在时，可以根据ECM或EMM对应的业务标识与权限文件对应的业
    
					务标识是否相同进行判断。
    
				</td></tr><tr><td class="content" id="description_83">步骤302：根据所述权限文件中的权限描述判断是否存在包月模式权限，
    若存在，则继续步骤303，否则，跳到步骤304。
    
				</td></tr><tr><td class="content" id="description_84">权限文件中包含权限描述，所述权限描述可以采用不同的取值表示不同
    的含义。例如：假设以0x00表示采用包月模式进行计费，以0x01表示采用
    观看次数模式进行计费，那么，本步骤中可以通过判断权限描述的取值确定
    是否存在包月模式权限。
    
				</td></tr><tr><td class="content" id="description_85">在同时存在包月模式权限与观看次数模式权限的情况下，可以优先采用
    包月模式进行计费。
    
				</td></tr><tr><td class="content" id="description_86">步骤303：判断当前时间是否超过过期时间，若未超过，则跳到步骤312；
    否则，跳到步骤307。
    
				</td></tr><tr><td class="content" id="description_87">由于包月权限方式下，通常是在一定期限届满之前可以使用相应的业
    务，因此，在包月模式下需判断当前时间是否超过对应的过期时间。
    
				</td></tr><tr><td class="content" id="description_88">步骤304：根据所述权限文件中的权限描述判断是否存在观看次数模式
    权限，若存在，继续执行步骤305。
    
				</td></tr><tr><td class="content" id="description_89">步骤305：判断剩余观看次数是否为0，若不为0，则继续执行步骤306；
    否则，跳到步骤307。
    
				</td></tr><tr><td class="content" id="description_90">步骤306：将剩余观看次数减一，并生成过期时间权限文件，跳到步骤
    312。
    
				</td></tr><tr><td class="content" id="description_91">步骤307：判断点数权限文件是否存在，若存在，则继续执行步骤308，
    否则，跳到步骤309。
    
				</td></tr><tr><td class="content" id="description_92">本步骤中，点数权限也可以称为预付费权限，预付费的金额被表示为点
    数，每次需要扣除的金额也转换为点数的形式进行扣除。
    
				</td></tr><tr><td class="content" id="description_93">步骤308：在点数权限文件中扣除相应的点数，生成过期时间权限文件，
    跳到步骤312。
    
				</td></tr><tr><td class="content" id="description_94">本步骤中，可以按照规定的资费标准从剩余的点数中扣除相应的点数，
    并在点数权限文件中改写相应的点数。
    
				</td></tr><tr><td class="content" id="description_95">步骤309：判断是否支持后付费模式，若支持，则继续执行步骤310；
    否则，跳到步骤311。
    
				</td></tr><tr><td class="content" id="description_96">步骤310：生成后付费权限文件，跳到步骤312。
    
				</td></tr><tr><td class="content" id="description_97">步骤311：鉴权失败，结束本鉴权计费流程。
    
				</td></tr><tr><td class="content" id="description_98">本步骤中，在鉴权失败之后，可以返回相应的错误码。
    
				</td></tr><tr><td class="content" id="description_99">步骤312：鉴权成功通过，结束本鉴权计费流程。
    
				</td></tr><tr><td class="content" id="description_100">至此，结束本较佳鉴权计费流程。
    
				</td></tr><tr><td class="content" id="description_101">对应于上述方法，本发明提供了一种在线下发授权信息的系统，下面对
    该系统进行详细说明。
    
				</td></tr><tr><td class="content" id="description_102">图4为本发明在线下发授权管理信息的系统的组成结构示意图。参见图
    4，该系统包括：CA系统410和CA终端420。
    
				</td></tr><tr><td class="content" id="description_103">其中，所述CA终端420包括移动终端421和卡422，所述移动终端421
    通过其接口模块423与卡422相连。
    
				</td></tr><tr><td class="content" id="description_104">图4中，所述CA系统410，用于对授权信息进行签名得到授权信息的
    签名信息，并将所述授权信息的签名信息、以及所述授权信息下发给所述移
    动终端421；
    
				</td></tr><tr><td class="content" id="description_105">所述移动终端421，用于通过接口模块423将所述授权信息的签名信息、
    以及所述授权信息发送给所述卡422；
    
				</td></tr><tr><td class="content" id="description_106">所述卡422，用于对所述授权信息的签名信息进行验证，在验证成功通
    过时，用于将所述授权信息保存在卡的安全区内。
    
				</td></tr><tr><td class="content" id="description_107">图4所示系统中，所述卡422可以为智能存储卡。此时，所述移动终端
    421，还可以用于将条件接收信息发送给所述智能存储卡422；
    
				</td></tr><tr><td class="content" id="description_108">所述智能存储卡422，还可以用于根据所述条件接收信息以及授权信息
    解密得到CW，根据CW对加扰的多媒体数据进行解扰，并将解扰得到的多
    媒体数据发送给所述移动终端421。
    
				</td></tr><tr><td class="content" id="description_109">图4所示CA系统，可以用于对授权信息或加密之后的授权信息进行签
    名。
    
				</td></tr><tr><td class="content" id="description_110">图4所示系统中的所述智能存储卡422中还可以包含权限控制模块424。
    所述权限控制模块424，用于根据条件接收信息对业务进行鉴权。
    
				</td></tr><tr><td class="content" id="description_111">在具体实现鉴权的过程中，图4所述智能存储卡422中的权限控制模块
    424首先判断与所述条件接收信息对应的权限文件是否存在，在与条件接收
    信息对应的权限文件不存在时，继续判断点数权限文件是否存在；在与条件
    接收信息对应的权限文件存在时，继续根据所述权限文件中的权限描述判断
    是否存在包月模式权限，在存在包月模式权限时，继续判断当前时间是否超
    过所述包月模式的过期时间，若未超过，则判定鉴权成功通过，否则，继续
    判断点数权限文件是否存在，在不存在包月模式权限时，继续判断是否存在
    观看次数模式权限，在存在观看次数权限、且剩余观看次数不为0时，将剩
    余观看次数减一，并生成过期时间权限文件，判定鉴权成功通过，在剩余观
    看次数为0时，继续判断点数权限文件是否存在；在点数权限文件存在时，
    在点数权限文件中扣除相应的点数，生成过期时间权限文件，判定鉴权成功
    通过，在点数权限文件不存在时，判断是否支持后付费模式，在支持时，生
    成后付费权限文件，判定鉴权成功通过，在不支持时，判定鉴权失败。
    
				</td></tr><tr><td class="content" id="description_112">图4所示权限控制模块424，用于根据条件接收信息对应的业务标识以
    及所述权限文件对应的业务标识是否相同判断与所述条件接收信息对应的
    权限文件是否存在。
    
				</td></tr><tr><td class="content" id="description_113">由上述实施例可见，本发明提供的在线下发授权信息的方法及系统，通
    过对授权信息进行签名，并将授权信息明文以及授权信息的签名信息下发，
    然后由移动终端将签名信息和授权信息明文传送给卡，最后由卡通过验证签
    名来认证授权信息的完整性。这样，能够保证授权信息在下发过程中的安全
    性。一旦授权信息被截获篡改，那么就无法通过智能存储卡的签名认证，从
    而保证了授权信息的安全性。授权信息验证通过后，将被保存在智能存储卡
    的安全区内并替换原有的已失效的授权信息。智能存储卡的安全区必须经过
    严格的身份认证才能访问，确保所存储的授权信息的安全性。此外，由于授
    权信息以明文形式下发，终端侧无需对授权信息进行解密，从而降低了终端
    
					侧的运算负荷。
    
				</td></tr><tr><td class="content" id="description_114">并且，采用本发明使得移动终端无需提供可靠的运行环境，使移动终端
    的成本得以降低。
    
				</td></tr><tr><td class="content" id="description_115">而且，采用基于本发明提供的下发授权信息的方法及系统向机卡分离式
    的CA终端下发授权信息，使得所有与条件接收相关的功能均由智能存储卡
    实现，所述功能包括：验证授权信息完整性、存储授权信息、解密CW、解
    扰等，从而使得用户只需拥有一张智能存储卡，即可在任意移动终端上接收
    移动多媒体广播节目，因此，实现了真正意义上的机卡分离。
    
				</td></tr><tr><td class="content" id="description_116">以上所述仅为本发明的较佳实施例而已，并非用于限定本发明的保护范
    围。凡在本发明的精神和原则之内所作的任何修改、等同替换、改进等，均
    应包含在本发明的保护范围之内。
    
				</td></tr></table></div></body></html>