<html><head><title>全文文本(Fulltext)</title><meta http-equiv='Content-Type' content='text/html; charset=UTF-8'><style>div.fullText table {width: 100%;text-indent: 1px;} 
 div.fullText table td.header {font-weight: bold;text-align: center;font-family: '宋体';font-size: 16px;line-height:20px;color: #000000;padding: 5px;}div.fullText table td.content {padding: 1px;text-align: left;vertical-align: top;width: 100%;font-family: '宋体';font-size: 14px;line-height:20px;color: #000000;}</style></head><body><?xml version="1.0" encoding="UTF-8"?><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" class="fullText"><table class="fullText"><tr><td id="claim_title" class="header">权利要求书</td></tr><tr><td class="content" id="claim_1">1、一种数据加密传输方法，其特征在于，该方法包括以下步骤：
			<br/>
				</td></tr><tr><td class="content" id="claim_2">在数据传输的发送端和接收端建立密钥空间和安全算法空间；
			<br/>
				</td></tr><tr><td class="content" id="claim_3">设置密钥空间更新条件、安全算法空间更新条件和安全算法更新条件；
			<br/>
				</td></tr><tr><td class="content" id="claim_4">判断密钥空间更新条件、安全算法空间更新条件和安全算法更新条件是否
			<br/>满足；
			<br/>
				</td></tr><tr><td class="content" id="claim_5">当密钥空间更新条件满足时，数据传输的发送端和接收端采用相同的方法
			<br/>更新密钥空间；当安全算法空间更新条件满足时，数据传输的发送端和接收端
			<br/>采用相同的方法更新安全算法空间；当安全算法更新条件满足时，数据传输的
			<br/>发送端和接收端采用相同的方法更新安全算法；
			<br/>
				</td></tr><tr><td class="content" id="claim_6">发送端基于更新的密钥空间或安全算法空间或安全算法确定数据传输加密
			<br/>密钥和安全算法，向接收端发送加密数据；
			<br/>
				</td></tr><tr><td class="content" id="claim_7">接收端采用与发送端相同的方法确定数据传输解密密钥和安全算法，对加
			<br/>密数据进行解密。
			<br/>
				</td></tr><tr><td class="content" id="claim_8">2、如权利要求1所述的数据加密传输方法，其特征在于，所述在数据传输
			<br/>的发送端和接收端建立密钥空间和安全算法空间包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_9">将所有密钥预先写入数据传输的发送端和接收端的密钥寄存器中；
			<br/>
				</td></tr><tr><td class="content" id="claim_10">在数据传输的发送端和接收端的密钥寄存器中，以每一个密钥作为一个元
			<br/>素，采用同样的抽取方法抽取N个元素，将该N个元素组成的样本作为密钥空
			<br/>间，其中N为所需建立的密钥空间中密钥的个数；
			<br/>
				</td></tr><tr><td class="content" id="claim_11">将所有安全算法预先写入数据传输的发送端和接收端的安全算法寄存器
			<br/>中；
			<br/>
				</td></tr><tr><td class="content" id="claim_12">在数据传输的发送端和接收端的安全算法寄存器中，以每一个安全算法作
			<br/>为一个元素，采用同样的抽取方法抽取K个元素，将该K个元素组成的样本作
			<br/>为安全算法空间，其中K为所需建立的安全算法空间中安全算法的个数。
			<br/>
				</td></tr><tr><td class="content" id="claim_13">3、如权利要求2所述的数据加密传输方法，其特征在于，
			<br/>
					
				</td></tr><tr><td class="content" id="claim_14">所述密钥空间包括对称密钥空间和非对称密钥空间，所述对称密钥空间由
			<br/>对称密钥组成，所述非对称密钥空间由非对称密钥组成；
			<br/>
				</td></tr><tr><td class="content" id="claim_15">所述安全算法空间包括对称安全算法空间和非对称安全算法空间，所述对
			<br/>称安全算法空间由对称安全算法组成，所述非对称安全算法空间由非对称安全
			<br/>算法组成；
			<br/>
				</td></tr><tr><td class="content" id="claim_16">所述对称安全算法采用的密钥从所述对称密钥空间中选择；所述非对称安
			<br/>全算法采用的密钥从所述非对称密钥空间中选择；
			<br/>
				</td></tr><tr><td class="content" id="claim_17">每个非对称密钥与每个非对称安全算法设置有一一对应的标识符。
			<br/>
				</td></tr><tr><td class="content" id="claim_18">4、如权利要求3所述的数据加密传输方法，其特征在于，
			<br/>
				</td></tr><tr><td class="content" id="claim_19">所述数据传输的发送端和接收端采用相同的方法更新密钥空间包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_20">把数据传输的发送端或接收端设定为控制端，另一端设定为被控制端；
			<br/>
				</td></tr><tr><td class="content" id="claim_21">控制端产生随机数，根据该随机数更新密钥空间，并将该随机数发送到被
			<br/>控制端，被控制端根据该随机数采用与控制端相同的方法更新密钥空间；
			<br/>
				</td></tr><tr><td class="content" id="claim_22">所述发送端基于更新的密钥空间或安全算法空间或安全算法确定数据传输
			<br/>加密密钥和安全算法包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_23">设置从密钥空间抽取当前数据传输所用密钥的密钥抽取方式和从安全算法
			<br/>空间抽取当前数据传输所用安全算法的安全算法抽取方式；
			<br/>
				</td></tr><tr><td class="content" id="claim_24">用加密数据的命令头模N，按照密钥抽取方式，根据命令头模N的结果在
			<br/>更新的密钥空间中抽取出一个密钥作为数据传输加密密钥，其中，N为密钥空
			<br/>间中密钥的个数；
			<br/>
				</td></tr><tr><td class="content" id="claim_25">如果数据传输加密密钥有标识符，则根据该密钥的标识符在安全算法空间
			<br/>中取出带有相同标识符的安全算法作为数据传输加密安全算法，如果该密钥没
			<br/>有标识符，则在没有标识符的安全算法中按照安全算法抽取方式选取一种安全
			<br/>算法作为数据传输加密安全算法。
			<br/>
				</td></tr><tr><td class="content" id="claim_26">5、如权利要求4所述的数据加密传输方法，其特征在于，所述根据该随机
			<br/>数更新密钥空间包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_27">配置N种密钥空间生成方式，分别以0至N-1为N种密钥空间生成方式编
			<br/>
					号，令R1模N，选择与R1模N的结果相同编号的密钥空间生成方式，将该密
			<br/>钥空间生成方式生成的密钥空间确定为更新的密钥空间，其中，N为密钥空间
			<br/>中密钥的个数，R1为该随机数；
			<br/>
				</td></tr><tr><td class="content" id="claim_28">或，
			<br/>
				</td></tr><tr><td class="content" id="claim_29">用R2分别与现有密钥空间中的每一个对称密钥进行异或运算，用异或运算
			<br/>的结果替代现有的对称密钥，由异或运算的结果构成的对称密钥空间与保持不
			<br/>变的非对称密钥空间组成更新的密钥空间，其中，R2为该随机数。
			<br/>
				</td></tr><tr><td class="content" id="claim_30">6、如权利要求3所述的数据加密传输方法，其特征在于，
			<br/>
				</td></tr><tr><td class="content" id="claim_31">所述数据传输的发送端和接收端采用相同的方法更新安全算法空间包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_32">把数据传输的发送端或接收端设定为控制端，另一端设定为被控制端；
			<br/>
				</td></tr><tr><td class="content" id="claim_33">控制端产生随机数，根据该随机数更新安全算法空间，并将该随机数发送
			<br/>到被控制端，被控制端根据该随机数采用与控制端相同的方法更新安全算法空
			<br/>间；
			<br/>
				</td></tr><tr><td class="content" id="claim_34">所述发送端基于更新的密钥空间或安全算法空间或安全算法确定数据传输
			<br/>加密密钥和安全算法包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_35">设置从密钥空间抽取当前数据传输所用密钥的密钥抽取方式和从安全算法
			<br/>空间抽取当前数据传输所用安全算法的安全算法抽取方式；
			<br/>
				</td></tr><tr><td class="content" id="claim_36">用加密数据的命令头模N，按照密钥抽取方式，根据命令头模N的结果在
			<br/>密钥空间中抽取出一个密钥作为数据传输加密密钥，其中，N为密钥空间中密
			<br/>钥的个数；
			<br/>
				</td></tr><tr><td class="content" id="claim_37">如果数据传输加密密钥有标识符，则根据该密钥的标识符在更新的安全算
			<br/>法空间中取出带有相同标识符的安全算法作为数据传输加密安全算法，如果该
			<br/>密钥没有标识符，则在没有标识符的安全算法中按照安全算法抽取方式选取一
			<br/>种安全算法作为数据传输加密安全算法。
			<br/>
				</td></tr><tr><td class="content" id="claim_38">7、如权利要求6所述的数据加密传输方法，其特征在于，所述根据该随机
			<br/>数更新安全算法空间包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_39">配置M种对称安全算法空间生成方式，分别以0至M-1为上述M种对称
			<br/>
					安全算法空间生成方式编号，令随机数R1模M，R3模M的结果为0至M-1
			<br/>中的一个值，选择与R3模M的结果相同编号的安全算法空间生成方式，将该
			<br/>安全算法空间生成方式生成的安全算法空间确定为更新的安全算法空间，其中，
			<br/>M为安全算法空间中对称安全算法的个数，R3为该随机数。
			<br/>
				</td></tr><tr><td class="content" id="claim_40">8、如权利要求3所述的数据加密传输方法，其特征在于，
			<br/>
				</td></tr><tr><td class="content" id="claim_41">所述数据传输的发送端和接收端采用相同的方法更新安全算法包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_42">把数据传输的发送端或接收端设定为控制端，另一端设定为被控制端；
			<br/>
				</td></tr><tr><td class="content" id="claim_43">控制端产生随机数，根据该随机数更新安全算法，并将该随机数发送到被
			<br/>控制端，被控制端根据该随机数采用与控制端相同的方法更新安全算法；
			<br/>
				</td></tr><tr><td class="content" id="claim_44">所述发送端基于更新的密钥空间或安全算法空间或安全算法确定数据传输
			<br/>加密密钥和安全算法包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_45">设置从密钥空间抽取当前数据传输所用密钥的密钥抽取方式和从安全算法
			<br/>空间抽取当前数据传输所用安全算法的安全算法抽取方式；
			<br/>
				</td></tr><tr><td class="content" id="claim_46">用加密数据的命令头模N1，按照密钥抽取方式，根据命令头模N1的结果
			<br/>在对称密钥空间中抽取出一个密钥作为数据传输加密密钥，其中，N1为密钥空
			<br/>间中对称密钥的个数；
			<br/>
				</td></tr><tr><td class="content" id="claim_47">采用更新的安全算法作为数据传输加密安全算法。
			<br/>
				</td></tr><tr><td class="content" id="claim_48">9、如权利要求8所述的数据加密传输方法，其特征在于，所述根据该随机
			<br/>数更新安全算法包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_49">令R4模M，R4模M的结果为0至M-1中的一个值，根据预先配置的安
			<br/>全算法抽取方式在对称安全算法空间中抽取与R4模M的结果对应的安全算法，
			<br/>将其确定为更新的安全算法，其中，M为安全算法空间中对称安全算法的个数，
			<br/>R4为该随机数。
			<br/>
				</td></tr><tr><td class="content" id="claim_50">10、如权利要求1所述的数据加密传输方法，其特征在于，所述在数据传
			<br/>输的发送端和接收端建立密钥空间和安全算法空间之前包括：数据传输的发送
			<br/>端和接收端进行身份认证。
			<br/>
				</td></tr><tr><td class="content" id="claim_51">11、一种数据加密传输装置，其特征在于，包括：
			<br/>
					
				</td></tr><tr><td class="content" id="claim_52">密钥寄存器，用于存储所有密钥；
			<br/>
				</td></tr><tr><td class="content" id="claim_53">安全算法寄存器，用于存储所有安全算法；
			<br/>
				</td></tr><tr><td class="content" id="claim_54">控制单元，通过从密钥寄存器中抽取密钥建立或更新密钥空间，通过从
			<br/>安全算法寄存器中抽取安全算法建立或更新安全算法空间；设置并判断密钥
			<br/>空间更新条件、安全算法空间更新条件和安全算法更新条件是否满足；当密
			<br/>钥空间更新条件满足时，更新密钥空间；当安全算法空间更新条件满足时，
			<br/>更新安全算法空间；当安全算法更新条件满足时，更新安全算法；基于更新
			<br/>的密钥空间或安全算法空间或安全算法确定数据传输密钥和安全算法，并提供
			<br/>给解密单元和加密单元；
			<br/>
				</td></tr><tr><td class="content" id="claim_55">接收单元，接收对方数据传输装置的加密数据并将其传送给解密单元；
			<br/>
				</td></tr><tr><td class="content" id="claim_56">解密单元，根据控制单元提供的密钥和安全算法对接收单元提供的加密
			<br/>数据进行解密；
			<br/>
				</td></tr><tr><td class="content" id="claim_57">加密单元，根据控制单元提供的密钥和安全算法对明文数据进行加密，
			<br/>将加密数据传送给发送单元；
			<br/>
				</td></tr><tr><td class="content" id="claim_58">发送单元，将加密单元提供的加密数据发送给对方数据传输装置。
			<br/>
				</td></tr><tr><td class="content" id="claim_59">12、如权利要求11所述的数据加密传输装置，其特征在于，该装置进一步
			<br/>包括：
			<br/>
				</td></tr><tr><td class="content" id="claim_60">密钥空间存储单元，用于存储密钥空间；
			<br/>
				</td></tr><tr><td class="content" id="claim_61">安全算法空间存储单元，用于存储安全算法。
			<br/>
					
				</td></tr></table></div><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" class="fullText"><table><tr><td id="description_title" class="header">说明书</td></tr><tr><td class="content" id="description_invention_title">一种数据加密传输方法及装置
	</td></tr><tr><td class="content" id="description_1"><p id="p0001" num="0001">技术领域
	</p></td></tr><tr><td class="content" id="description_2"><p id="p0002" num="0002">本发明涉及数据传输技术，特别涉及一种数据加密传输的方法及装置。
		<br/>
			</p></td></tr><tr><td class="content" id="description_3"><p id="p0003" num="0003">背景技术
	</p></td></tr><tr><td class="content" id="description_4"><p id="p0004" num="0004">目前，在数据传输过程中对安全性的要求越来越高。在现有的数据传输
		<br/>技术中，一般采用以下两种方式保证数据的安全性，即：将明文数据加密后
		<br/>再进行传输，或者在传输数据前预先对传输数据的双方进行身份认证。现有
		<br/>技术中可以单独使用上述某一种方式，但通常是将两种方式结合使用，即在
		<br/>双方身份认证之后将明文数据加密传输。
		<br/>
			</p></td></tr><tr><td class="content" id="description_5"><p id="p0005" num="0005">将明文数据加密后再进行传输的具体做法是：发送端利用某一个密钥，
		<br/>采用安全算法对密钥和明文数据进行处理，得到加密数据并传输给接收端；
		<br/>接收端接收到加密数据后，采用相同的密钥和安全算法对加密数据进行解
		<br/>密，还原出明文数据。
		<br/>
			</p></td></tr><tr><td class="content" id="description_6"><p id="p0006" num="0006">现有的数据传输技术中，基于实现各种安全目的的途径及各种安全需求
		<br/>不同，产生了各种安全算法。根据安全级别的高低，各种加密算法的复杂程
		<br/>度不同。但是对于某一种应用，数据加密使用的安全算法和密钥都是固定不
		<br/>变的，因此数据传输的安全性较低。以传输某一条指令为例，因为相同指令
		<br/>使用的安全算法和密钥是固定不变的，所以如果这条指令在某一次传输中被
		<br/>破解，破解者获取了安全算法和密钥，那么在之后的每一次传输中，破解者
		<br/>都可以利用相同的安全算法和密钥破解这条指令。由此可见，现有数据传输
		<br/>技术中的安全算法和密钥固定不变使得数据传输的安全性较低。
		<br/>
			</p></td></tr><tr><td class="content" id="description_7"><p id="p0007" num="0007">发明内容
	</p></td></tr><tr><td class="content" id="description_8"><p id="p0008" num="0008">本发明提供一种数据加密传输方法，应用该方法能够使密钥和安全算法
		<br/>
				动态更新。
		<br/>
			</p></td></tr><tr><td class="content" id="description_9"><p id="p0009" num="0009">本发明还提供一种数据加密传输装置，应用该装置能够使密钥和安全算
		<br/>法动态更新。
		<br/>
			</p></td></tr><tr><td class="content" id="description_10"><p id="p0010" num="0010">本发明的技术方案具体是这样实现的：
		<br/>
			</p></td></tr><tr><td class="content" id="description_11"><p id="p0011" num="0011">一种数据加密传输方法，该方法包括以下步骤：
		<br/>
			</p></td></tr><tr><td class="content" id="description_12"><p id="p0012" num="0012">在数据传输的发送端和接收端建立密钥空间和安全算法空间；
		<br/>
			</p></td></tr><tr><td class="content" id="description_13"><p id="p0013" num="0013">设置密钥空间更新条件、安全算法空间更新条件和安全算法更新条件；
		<br/>
			</p></td></tr><tr><td class="content" id="description_14"><p id="p0014" num="0014">判断密钥空间更新条件、安全算法空间更新条件和安全算法更新条件是否
		<br/>满足；
		<br/>
			</p></td></tr><tr><td class="content" id="description_15"><p id="p0015" num="0015">当密钥空间更新条件满足时，数据传输的发送端和接收端采用相同的方法
		<br/>更新密钥空间；当安全算法空间更新条件满足时，数据传输的发送端和接收端
		<br/>采用相同的方法更新安全算法空间；当安全算法更新条件满足时，数据传输的
		<br/>发送端和接收端采用相同的方法更新安全算法；
		<br/>
			</p></td></tr><tr><td class="content" id="description_16"><p id="p0016" num="0016">发送端基于更新的密钥空间或安全算法空间或安全算法确定数据传输加密
		<br/>密钥和安全算法，向接收端发送加密数据；
		<br/>
			</p></td></tr><tr><td class="content" id="description_17"><p id="p0017" num="0017">接收端采用与发送端相同的方法确定数据传输解密密钥和安全算法，对加
		<br/>密数据进行解密。
		<br/>
			</p></td></tr><tr><td class="content" id="description_18"><p id="p0018" num="0018">所述在数据传输的发送端和接收端建立密钥空间和安全算法空间包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_19"><p id="p0019" num="0019">将所有密钥预先写入数据传输的发送端和接收端的密钥寄存器中；
		<br/>
			</p></td></tr><tr><td class="content" id="description_20"><p id="p0020" num="0020">在数据传输的发送端和接收端的密钥寄存器中，以每一个密钥作为一个元
		<br/>素，采用同样的抽取方法抽取N个元素，将该N个元素组成的样本作为密钥空
		<br/>间，其中N为所需建立的密钥空间中密钥的个数；
		<br/>
			</p></td></tr><tr><td class="content" id="description_21"><p id="p0021" num="0021">将所有安全算法预先写入数据传输的发送端和接收端的安全算法寄存器
		<br/>中；
		<br/>
			</p></td></tr><tr><td class="content" id="description_22"><p id="p0022" num="0022">在数据传输的发送端和接收端的安全算法寄存器中，以每一个安全算法作
		<br/>为一个元素，采用同样的抽取方法抽取K个元素，将该K个元素组成的样本作
		<br/>为安全算法空间，其中K为所需建立的安全算法空间中安全算法的个数。
		<br/>
			</p></td></tr><tr><td class="content" id="description_23"><p id="p0023" num="0023">所述密钥空间包括对称密钥空间和非对称密钥空间，所述对称密钥空间由
		<br/>对称密钥组成，所述非对称密钥空间由非对称密钥组成；
		<br/>
			</p></td></tr><tr><td class="content" id="description_24"><p id="p0024" num="0024">所述安全算法空间包括对称安全算法空间和非对称安全算法空间，所述对
		<br/>称安全算法空间由对称安全算法组成，所述非对称安全算法空间由非对称安全
		<br/>算法组成；
		<br/>
			</p></td></tr><tr><td class="content" id="description_25"><p id="p0025" num="0025">所述对称安全算法采用的密钥从所述对称密钥空间中选择；所述非对称安
		<br/>全算法采用的密钥从所述非对称密钥空间中选择；
		<br/>
			</p></td></tr><tr><td class="content" id="description_26"><p id="p0026" num="0026">每个非对称密钥与每个非对称安全算法设置有一一对应的标识符。
		<br/>
			</p></td></tr><tr><td class="content" id="description_27"><p id="p0027" num="0027">所述数据传输的发送端和接收端采用相同的方法更新密钥空间包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_28"><p id="p0028" num="0028">把数据传输的发送端或接收端设定为控制端，另一端设定为被控制端；
		<br/>
			</p></td></tr><tr><td class="content" id="description_29"><p id="p0029" num="0029">控制端产生随机数，根据该随机数更新密钥空间，并将该随机数发送到被
		<br/>控制端，被控制端根据该随机数采用与控制端相同的方法更新密钥空间；
		<br/>
			</p></td></tr><tr><td class="content" id="description_30"><p id="p0030" num="0030">所述发送端基于更新的密钥空间或安全算法空间或安全算法确定数据传输
		<br/>加密密钥和安全算法包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_31"><p id="p0031" num="0031">设置从密钥空间抽取当前数据传输所用密钥的密钥抽取方式和从安全算法
		<br/>空间抽取当前数据传输所用安全算法的安全算法抽取方式；
		<br/>
			</p></td></tr><tr><td class="content" id="description_32"><p id="p0032" num="0032">用加密数据的命令头模N，按照密钥抽取方式，根据命令头模N的结果在
		<br/>更新的密钥空间中抽取出一个密钥作为数据传输加密密钥，其中，N为密钥空
		<br/>间中密钥的个数；
		<br/>
			</p></td></tr><tr><td class="content" id="description_33"><p id="p0033" num="0033">如果数据传输加密密钥有标识符，则根据该密钥的标识符在安全算法空间
		<br/>中取出带有相同标识符的安全算法作为数据传输加密安全算法，如果该密钥没
		<br/>有标识符，则在没有标识符的安全算法中按照安全算法抽取方式选取一种安全
		<br/>算法作为数据传输加密安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_34"><p id="p0034" num="0034">所述根据该随机数更新密钥空间包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_35"><p id="p0035" num="0035">配置N种密钥空间生成方式，分别以0至N-1为N种密钥空间生成方式编
		<br/>号，令R1模N，选择与R1模N的结果相同编号的密钥空间生成方式，将该密
		<br/>钥空间生成方式生成的密钥空间确定为更新的密钥空间，其中，N为密钥空间
		<br/>
				中密钥的个数，R1为该随机数；
		<br/>
			</p></td></tr><tr><td class="content" id="description_36"><p id="p0036" num="0036">或，
		<br/>
			</p></td></tr><tr><td class="content" id="description_37"><p id="p0037" num="0037">用R2分别与现有密钥空间中的每一个对称密钥进行异或运算，用异或运算
		<br/>的结果替代现有的对称密钥，由异或运算的结果构成的对称密钥空间与保持不
		<br/>变的非对称密钥空间组成更新的密钥空间，其中，R2为该随机数。
		<br/>
			</p></td></tr><tr><td class="content" id="description_38"><p id="p0038" num="0038">所述数据传输的发送端和接收端采用相同的方法更新安全算法空间包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_39"><p id="p0039" num="0039">把数据传输的发送端或接收端设定为控制端，另一端设定为被控制端；
		<br/>
			</p></td></tr><tr><td class="content" id="description_40"><p id="p0040" num="0040">控制端产生随机数，根据该随机数更新安全算法空间，并将该随机数发送
		<br/>到被控制端，被控制端根据该随机数采用与控制端相同的方法更新安全算法空
		<br/>间；
		<br/>
			</p></td></tr><tr><td class="content" id="description_41"><p id="p0041" num="0041">所述发送端基于更新的密钥空间或安全算法空间或安全算法确定数据传输
		<br/>加密密钥和安全算法包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_42"><p id="p0042" num="0042">设置从密钥空间抽取当前数据传输所用密钥的密钥抽取方式和从安全算法
		<br/>空间抽取当前数据传输所用安全算法的安全算法抽取方式；
		<br/>
			</p></td></tr><tr><td class="content" id="description_43"><p id="p0043" num="0043">用加密数据的命令头模N，按照密钥抽取方式，根据命令头模N的结果在
		<br/>密钥空间中抽取出一个密钥作为数据传输加密密钥，其中，N为密钥空间中密
		<br/>钥的个数；
		<br/>
			</p></td></tr><tr><td class="content" id="description_44"><p id="p0044" num="0044">如果数据传输加密密钥有标识符，则根据该密钥的标识符在更新的安全算
		<br/>法空间中取出带有相同标识符的安全算法作为数据传输加密安全算法，如果该
		<br/>密钥没有标识符，则在没有标识符的安全算法中按照安全算法抽取方式选取一
		<br/>种安全算法作为数据传输加密安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_45"><p id="p0045" num="0045">所述根据该随机数更新安全算法空间包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_46"><p id="p0046" num="0046">配置M种对称安全算法空间生成方式，分别以0至M-1为上述M种对称
		<br/>安全算法空间生成方式编号，令随机数R1模M，R3模M的结果为0至M-1
		<br/>中的一个值，选择与R3模M的结果相同编号的安全算法空间生成方式，将该
		<br/>安全算法空间生成方式生成的安全算法空间确定为更新的安全算法空间，其中，
		<br/>M为安全算法空间中对称安全算法的个数，R3为该随机数。
		<br/>
			</p></td></tr><tr><td class="content" id="description_47"><p id="p0047" num="0047">所述数据传输的发送端和接收端采用相同的方法更新安全算法包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_48"><p id="p0048" num="0048">把数据传输的发送端或接收端设定为控制端，另一端设定为被控制端；
		<br/>
			</p></td></tr><tr><td class="content" id="description_49"><p id="p0049" num="0049">控制端产生随机数，根据该随机数更新安全算法，并将该随机数发送到被
		<br/>控制端，被控制端根据该随机数采用与控制端相同的方法更新安全算法；
		<br/>
			</p></td></tr><tr><td class="content" id="description_50"><p id="p0050" num="0050">所述发送端基于更新的密钥空间或安全算法空间或安全算法确定数据传输
		<br/>加密密钥和安全算法包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_51"><p id="p0051" num="0051">设置从密钥空间抽取当前数据传输所用密钥的密钥抽取方式和从安全算法
		<br/>空间抽取当前数据传输所用安全算法的安全算法抽取方式；
		<br/>
			</p></td></tr><tr><td class="content" id="description_52"><p id="p0052" num="0052">用加密数据的命令头模N1，按照密钥抽取方式，根据命令头模N1的结果
		<br/>在对称密钥空间中抽取出一个密钥作为数据传输加密密钥，其中，N1为密钥空
		<br/>间中对称密钥的个数；
		<br/>
			</p></td></tr><tr><td class="content" id="description_53"><p id="p0053" num="0053">采用更新的安全算法作为数据传输加密安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_54"><p id="p0054" num="0054">所述根据该随机数更新安全算法包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_55"><p id="p0055" num="0055">令R4模M，R4模M的结果为0至M-1中的一个值，根据预先配置的安
		<br/>全算法抽取方式在对称安全算法空间中抽取与R4模M的结果对应的安全算法，
		<br/>将其确定为更新的安全算法，其中，M为安全算法空间中对称安全算法的个数，
		<br/>R4为该随机数。
		<br/>
			</p></td></tr><tr><td class="content" id="description_56"><p id="p0056" num="0056">所述在数据传输的发送端和接收端建立密钥空间和安全算法空间之前包
		<br/>括：数据传输的发送端和接收端进行身份认证。
		<br/>
			</p></td></tr><tr><td class="content" id="description_57"><p id="p0057" num="0057">一种数据加密传输装置，包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_58"><p id="p0058" num="0058">密钥寄存器，用于存储所有密钥；
		<br/>
			</p></td></tr><tr><td class="content" id="description_59"><p id="p0059" num="0059">安全算法寄存器，用于存储所有安全算法；
		<br/>
			</p></td></tr><tr><td class="content" id="description_60"><p id="p0060" num="0060">控制单元，通过从密钥寄存器中抽取密钥建立或更新密钥空间，通过从
		<br/>安全算法寄存器中抽取安全算法建立或更新安全算法空间；设置并判断密钥
		<br/>空间更新条件、安全算法空间更新条件和安全算法更新条件是否满足；当密
		<br/>钥空间更新条件满足时，更新密钥空间；当安全算法空间更新条件满足时，
		<br/>更新安全算法空间；当安全算法更新条件满足时，更新安全算法；基于更新
		<br/>
				的密钥空间或安全算法空间或安全算法确定数据传输密钥和安全算法，并提供
		<br/>给解密单元和加密单元；
		<br/>
			</p></td></tr><tr><td class="content" id="description_61"><p id="p0061" num="0061">接收单元，接收对方数据传输装置的加密数据并将其传送给解密单元；
		<br/>
			</p></td></tr><tr><td class="content" id="description_62"><p id="p0062" num="0062">解密单元，根据控制单元提供的密钥和安全算法对接收单元提供的加密
		<br/>数据进行解密；
		<br/>
			</p></td></tr><tr><td class="content" id="description_63"><p id="p0063" num="0063">加密单元，根据控制单元提供的密钥和安全算法对明文数据进行加密，
		<br/>将加密数据传送给发送单元；
		<br/>
			</p></td></tr><tr><td class="content" id="description_64"><p id="p0064" num="0064">发送单元，将加密单元提供的加密数据发送给对方数据传输装置。
		<br/>
			</p></td></tr><tr><td class="content" id="description_65"><p id="p0065" num="0065">该装置进一步包括：
		<br/>
			</p></td></tr><tr><td class="content" id="description_66"><p id="p0066" num="0066">密钥空间存储单元，用于存储密钥空间；
		<br/>
			</p></td></tr><tr><td class="content" id="description_67"><p id="p0067" num="0067">安全算法空间存储单元，用于存储安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_68"><p id="p0068" num="0068">由上述的技术方案可见，本发明在数据传输的双方均设置密钥空间和安
		<br/>全算法空间，并且分别为密钥空间、安全算法空间、安全算法设置更新条件。
		<br/>在数据传输时，分别从密钥空间和安全算法空间抽取当前数据传输的密钥和
		<br/>安全算法，利用密钥和安全算法将明文数据加密后进行传输。当对应更新条
		<br/>件满足时，同步更新数据传输双方的密钥空间、安全算法空间或安全算法，
		<br/>从而使得数据传输中使用的密钥和安全算法的不确定性增大，增强了数据传
		<br/>输的安全性。并且本发明提出的密钥空间、安全算法空间和安全算法更新方
		<br/>法无需复杂运算，简单易行。
		<br/>
			</p></td></tr><tr><td class="content" id="description_69"><p id="p0069" num="0069">附图说明
	</p></td></tr><tr><td class="content" id="description_70"><p id="p0070" num="0070">图1为第一种更新密钥空间的数据加密传输方法的信令流程图；
		<br/>
			</p></td></tr><tr><td class="content" id="description_71"><p id="p0071" num="0071">图2为第二种更新密钥空间的数据加密传输方法的信令流程图；
		<br/>
			</p></td></tr><tr><td class="content" id="description_72"><p id="p0072" num="0072">图3为更新安全算法空间的数据加密传输方法的信令流程图；
		<br/>
			</p></td></tr><tr><td class="content" id="description_73"><p id="p0073" num="0073">图4为更新安全算法的数据加密传输方法的信令流程图。
		<br/>
			</p></td></tr><tr><td class="content" id="description_74"><p id="p0074" num="0074">图5为本发明一较佳实施例数据加密传输装置的结构图。
		<br/>
			</p></td></tr><tr><td class="content" id="description_75"><p id="p0075" num="0075">具体实施方式
	</p></td></tr><tr><td class="content" id="description_76"><p id="p0076" num="0076">为使本发明的目的、技术方案及优点更加清楚明白，以下参照附图并举
		<br/>实施例，对本发明进一步详细说明。
		<br/>
			</p></td></tr><tr><td class="content" id="description_77"><p id="p0077" num="0077">本发明实施例采用现有技术中将明文数据加密后再进行传输的方式，并
		<br/>且，还可以在传输数据前预先对传输数据的双方进行身份认证。在此基础上，
		<br/>本发明实施例在数据传输的双方均设置密钥空间和安全算法空间，并且分别
		<br/>为密钥空间、安全算法空间、安全算法设置更新条件。在数据传输时，分别
		<br/>从密钥空间和安全算法空间抽取当前数据传输的密钥和安全算法，通过更新
		<br/>密钥空间、安全算法空间或安全算法更新当前数据传输的密钥和安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_78"><p id="p0078" num="0078">密钥空间是当前数据传输所有可选密钥的集合，安全算法空间是当前数
		<br/>据传输所有可选安全算法的集合。在生产数据传输设备时，生产厂商将所有
		<br/>密钥预先写入密钥寄存器中；将所有安全算法预先写入安全算法寄存器中。
		<br/>在数据传输之前，在数据传输双方预先建立密钥空间和安全算法空间。下面
		<br/>以建立密钥个数为N的密钥空间为例说明其建立方法：在密钥寄存器中，
		<br/>以每一个密钥作为一个元素，任意抽取N个元素所获得的一个样本即为一
		<br/>个密钥空间，采用上述方法，在数据传输双方采用同样的抽取方式建立完全
		<br/>一致的密钥空间。在双方密钥空间建立完成后，配置密钥抽取方式，在数据
		<br/>传输过程中，数据传输双方按照设置的密钥抽取方式从各自的密钥空间中抽
		<br/>取当前数据传输所用的密钥。对于安全算法空间，采用与建立密钥空间同样
		<br/>的方法，在数据传输双方建立完全一致的安全算法空间，并设置安全算法抽
		<br/>取方式，根据安全算法抽取方式从安全算法空间中抽取当前数据传输所用的
		<br/>安全算法。在数据传输设备中，可以单独设置一个存储单元作为密钥空间和
		<br/>安全算法空间，也可以将数据传输设备现有的存储单元中的一部分存储空间
		<br/>作为密钥空间和安全算法空间，将采用上述方法抽取的密钥和安全算法分别
		<br/>从密钥寄存器和安全算法寄存器中复制到该存储单元，当更新密钥空间和安
		<br/>全算法空间时，将该存储单元中的密钥和安全算法删除，重新复制新抽取的
		<br/>
				密钥和安全算法；或者，本发明实施例中设置的密钥空间和安全算法空间还
		<br/>可以不具有物理存储单元，而是在密钥寄存器和安全算法寄存器中对采用上
		<br/>述方法抽取的密钥和安全算法进行标记，以所有带有标记的密钥组成密钥空
		<br/>间，以所有带有标记的安全算法组成安全算法空间，当更新密钥空间和安全
		<br/>算法空间时，去掉密钥和安全算法的所有标记，对新抽取的密钥和安全算法
		<br/>重新进行标记。
		<br/>
			</p></td></tr><tr><td class="content" id="description_79"><p id="p0079" num="0079">鉴于安全等级的考虑，目前的安全算法分为对称安全算法和非对称安全
		<br/>算法两类，相应的，密钥也分为对称密钥和非对称密钥两类，对称安全算法
		<br/>采用对称密钥，非对称安全算法采用非对称密钥。因此，本发明实施例设置
		<br/>的密钥空间和安全算法空间均包括两部分。密钥空间包括对称密钥空间和非
		<br/>对称密钥空间；安全算法空间包括对称安全算法空间和非对称安全算法空
		<br/>间。对称密钥空间与对称安全算法空间相对应，对称密钥空间由对称密钥组
		<br/>成，对称安全算法空间由对称安全算法组成，对称安全算法采用的密钥从对
		<br/>称密钥空间中选择。非对称密钥空间与非对称安全算法空间相对应，非对称
		<br/>密钥空间由非对称密钥组成，非对称安全算法空间由非对称安全算法组成，
		<br/>非对称安全算法采用的密钥从非对称密钥空间中选择。本发明实施例为每个
		<br/>非对称密钥设置不同的标识符，并且采用每个非对称密钥的标识符标记一个
		<br/>非对称安全算法，从而保证非对称算法和非对称密钥之间的一一对应关系，
		<br/>在密钥空间和安全算法空间更新时，非对称密钥和非对称安全算法仍能互相
		<br/>匹配。而对于对称算法和对称密钥，可以任意组合使用。因此，可以将密钥
		<br/>的抽取方式设置为：将全体密钥升序排列后抽取指定位置的密钥；将安全算
		<br/>法的抽取方式设置为：如果抽取的密钥为有标识符的密钥，从非对称安全算
		<br/>法空间中抽取标识符与该密钥的标识符相同的安全算法；如果抽取的密钥为
		<br/>没有标识符的密钥，将全体对称安全算法升序排列后抽取指定位置的安全算
		<br/>法。并且，密钥或安全算法的抽取方式也可以采用其它多种方式，例如降序
		<br/>排列后依次抽取或隔位抽取等，只要保证每一个非对称密钥与非对称安全算
		<br/>法的对应关系，可以采用任何抽取方式。
		<br/>
			</p></td></tr><tr><td class="content" id="description_80"><p id="p0080" num="0080">本发明实施例中，密钥空间、安全算法、安全算法空间的更新条件在数
		<br/>据传输前预先设置，将数据传输的发送端与接收端中某一端设置为控制端，
		<br/>另一端设置为被控制端，由控制端确定更新条件是否满足。例如，在主机端
		<br/>与设备端之间进行数据传输，可以将主机端设为控制端，设备端设为被控制
		<br/>端，将密钥更新条件预先设置为每经过设定次数的数据传输更新密钥，则在
		<br/>数据传输过程中，主机端为数据传输次数计数，每经过设定次数的数据传输
		<br/>之后，主机端判断密钥更新条件满足，启动密钥更新过程，同时更新主机端
		<br/>与设备端的密钥。以上只是更新条件设置的一个具体实例，还可以采用其它
		<br/>多种更新条件，比如可以把更新条件设置为每隔某一具体时间更新，或被控
		<br/>制端发起更新请求后更新等等。并且，可以将密钥空间、安全算法、安全算
		<br/>法空间的更新条件设置为各自独立的，也可以令其中一个或多个更新条件相
		<br/>互关联，例如在密钥空间更新条件满足时视为安全算法空间更新条件也满
		<br/>足，对密钥空间和安全算法空间同时进行更新。
		<br/>
			</p></td></tr><tr><td class="content" id="description_81"><p id="p0081" num="0081">本发明实施例的数据加密传输方法，可以在数据传输过程中通过更新密
		<br/>钥空间或安全算法空间更新当前数据传输的密钥和安全算法，或直接更新当
		<br/>前数据传输的安全算法，根据密钥空间、安全算法空间或安全算法的更新条
		<br/>件的不同设置，既可以只更新其中一项，也可以更新任意两项或多项。其中，
		<br/>有两种方法更新密钥空间，相应地，可以针对这两种方法分别设置不同的两
		<br/>种密钥空间更新条件。例如，数据传输的双方在连续进行的四次数据传输中，
		<br/>可以每一次数据传输都通过更新密钥空间来更新当前数据传输的密钥和安
		<br/>全算法，也可以在四次数据传输中按照不同的顺序分别通过更新密钥空间或
		<br/>安全算法空间来更新当前传输的密钥和安全算法，或者直接更新当前传输的
		<br/>安全算法，还可以在某一次数据传输中同时更新密钥空间和安全算法空间，
		<br/>甚至在一次数据传输中同时更新上述三项。根据顺序的不同，本领域技术人
		<br/>员可以设想到多种动态更新的组合方式，本文仅以在一次数据传输中更新其
		<br/>中一项为例，举出四个实施例分别说明更新密钥空间、安全算法空间和安全
		<br/>算法的数据加密传输方法，其中更新密钥空间有两种实现方法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_82"><p id="p0082" num="0082">下述四个实施例中，均以主机端作为发送端，以设备端作为接收端，以
		<br/>主机端向设备端传输数据为例，并且以主机端作为控制端，以设备端作为被
		<br/>控制端。此处仅以下述四个实施例作为例子说明动态更新的数据加密传输方
		<br/>法，在其它的实施例中，本领域技术人员可以设想到，根据数据传输的具体
		<br/>情况还可以有多种方式设定数据传输的发送端与接收端，并且可以有多种方
		<br/>式设定控制端。并且，下述四个实施例中，在数据传输之前均已按照上文所
		<br/>述方法建立主机端和设备端的密钥空间和安全算法空间，并且预先设置密钥
		<br/>抽取方式和安全算法抽取方式。
		<br/>
			</p></td></tr><tr><td class="content" id="description_83"><p id="p0083" num="0083">实施例1：第一种更新密钥空间的数据加密传输方法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_84"><p id="p0084" num="0084">本实施例采用第一种方法更新密钥空间，不改变设备生产时写入密钥存
		<br/>储器中的密钥，而是从密钥寄存器中重新抽取密钥组成新的密钥空间，因此
		<br/>第一种方法更新密钥空间包括两种情况，一是至少改变密钥空间中的一个密
		<br/>钥；二是不改变密钥空间中的密钥，但是改变密钥的排列顺序。
		<br/>
			</p></td></tr><tr><td class="content" id="description_85"><p id="p0085" num="0085">图1为第一种更新密钥空间的数据加密传输方法的信令流程图，参见图
		<br/>1，该方法包括以下步骤：
		<br/>
			</p></td></tr><tr><td class="content" id="description_86"><p id="p0086" num="0086">步骤101，主机端判断密钥空间更新条件是否满足，当密钥空间更新条
		<br/>件满足时，主机端产生随机数R1，根据R1更新密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_87"><p id="p0087" num="0087">此步骤中，根据R1更新密钥空间的方法很多，此处仅以以下方法为例，
		<br/>也可以采用其它的方法根据R1更新密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_88"><p id="p0088" num="0088">将更新前已建立的密钥空间中密钥的个数记为N，配置N种密钥空间
		<br/>生成方式，分别以0至N-1为上述N种密钥空间生成方式编号，令随机数
		<br/>R1模N，R1模N的结果为0至N-1中的一个值，选择与R1模N的结果相
		<br/>同编号的密钥空间生成方式，将该密钥空间生成方式生成的密钥空间确定为
		<br/>更新的密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_89"><p id="p0089" num="0089">例如，更新前已建立了密钥个数为3的密钥空间，则N＝3，配置3种密
		<br/>钥空间生成方式，分别以0、1、2为上述3种密钥空间生成方式编号，例如
		<br/>这3种密钥空间生成方式分别为：编号为0的密钥空间生成方式为从密钥寄
		<br/>
				存器中取出最后3个密钥组成密钥空间；编号为1的密钥空间生成方式为从
		<br/>密钥寄存器中取出第1、3、5个密钥组成密钥空间；编号为2的密钥空间生
		<br/>成方式为从密钥寄存器中取出第2、4、8个密钥组成密钥空间，如果随机数
		<br/>R1模3的结果为1，则采用编号为1的密钥空间生成方式，从密钥寄存器中
		<br/>取出第1、3、5个密钥组成密钥空间确定为更新的密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_90"><p id="p0090" num="0090">步骤102，主机端将随机数R1发送到设备端。
		<br/>
			</p></td></tr><tr><td class="content" id="description_91"><p id="p0091" num="0091">步骤103，设备端收到随机数R1，采用与步骤101中主机端相同的方
		<br/>法，根据R1更新密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_92"><p id="p0092" num="0092">步骤104，设备端向主机端返回状态字，报告密钥空间更新完成。
		<br/>
			</p></td></tr><tr><td class="content" id="description_93"><p id="p0093" num="0093">步骤101至步骤104完成了主机端与设备端的密钥空间更新，在完成双
		<br/>方的密钥空间更新后，双方以更新的密钥空间为基础进行数据传输，从而在
		<br/>之后的数据传输中更新密钥和安全算法，数据传输的详细步骤如下：
		<br/>
			</p></td></tr><tr><td class="content" id="description_94"><p id="p0094" num="0094">步骤105，主机端收到状态字后向设备端发送加密数据。
		<br/>
			</p></td></tr><tr><td class="content" id="description_95"><p id="p0095" num="0095">此步骤中，主机端发送的加密数据由命令头和数据域组成，主机端根据
		<br/>命令头确定当前数据传输加密所用的密钥，并根据该密钥确定安全算法，采
		<br/>用根据命令头确定的密钥和安全算法加密明文数据后写入数据域。
		<br/>
			</p></td></tr><tr><td class="content" id="description_96"><p id="p0096" num="0096">根据命令头确定当前数据传输加密密钥的方法是：用命令头模N，按照
		<br/>预先配置的密钥抽取方式，根据命令头模N的结果在更新的密钥空间中抽
		<br/>取出一个密钥作为当前数据传输加密的密钥。根据命令头确定当前数据传输
		<br/>加密安全算法的方法是：按照预先配置的安全算法抽取方式，如果根据命令
		<br/>头确定的加密密钥有标识符，说明该密钥为非对称密钥，则根据该密钥的标
		<br/>识符在安全算法空间中取出带有相同标识符的安全算法，如果该密钥没有标
		<br/>识符，说明该密钥为对称密钥，则在没有标识符的安全算法中按照预先配置
		<br/>的安全算法抽取方式取出一种安全算法，将取出的安全算法作为当前数据传
		<br/>输加密安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_97"><p id="p0097" num="0097">步骤106，设备端收到加密数据，采用与步骤105中主机端相同的方法，
		<br/>根据命令头确定解密所用的密钥，并根据该密钥确定安全算法，用该密钥和
		<br/>
				安全算法对数据域进行解密。
		<br/>
			</p></td></tr><tr><td class="content" id="description_98"><p id="p0098" num="0098">步骤107，设备端向主机端返回状态字，报告数据域解密完成。
		<br/>
			</p></td></tr><tr><td class="content" id="description_99"><p id="p0099" num="0099">步骤108，主机端收到状态字后判断密钥空间更新条件是否满足，当密
		<br/>钥空间更新条件满足时，返回步骤101，更新密钥空间；当密钥空间更新条
		<br/>件不满足时，返回步骤105，再次发送加密数据。主机端继续发送加密数据，
		<br/>直到密钥空间更新条件满足。
		<br/>
			</p></td></tr><tr><td class="content" id="description_100"><p id="p0100" num="0100">由实施例1的以上步骤可以看出，通过在密钥寄存器中重新抽取密钥更
		<br/>新密钥空间，数据传输的密钥在密钥空间中选择，并且根据数据传输的密钥
		<br/>选择安全算法，因此，当密钥空间更新后，数据传输所用密钥和安全算法同
		<br/>时更新，提高了数据传输的安全性。
		<br/>
			</p></td></tr><tr><td class="content" id="description_101"><p id="p0101" num="0101">实施例2：第二种更新密钥空间的数据加密传输方法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_102"><p id="p0102" num="0102">本实施例采用第二种方法更新密钥空间，通过产生新密钥替代密钥空间
		<br/>中的所有对称密钥。为了提高更新速率，减少认证过程的复杂性，本实施例
		<br/>中仅替代密钥空间中的对称密钥，而不改变非对称密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_103"><p id="p0103" num="0103">图2为第二种更新密钥空间的数据加密传输方法的信令流程图。参见图
		<br/>2，该方法包括以下步骤：
		<br/>
			</p></td></tr><tr><td class="content" id="description_104"><p id="p0104" num="0104">步骤201，主机端判断密钥空间更新条件是否满足，当密钥空间更新条
		<br/>件满足时，主机端产生随机数R2，根据R2更新密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_105"><p id="p0105" num="0105">此步骤中，根据R2更新密钥空间的方法很多，此处仅以以下方法为例，
		<br/>也可以采用其它的方法根据R2更新密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_106"><p id="p0106" num="0106">主机端用R2分别与现有密钥空间中的每一个对称密钥进行异或运算，
		<br/>用异或运算的结果替代现有的对称密钥，由异或运算的结果构成对称密钥空
		<br/>间，保持非对称密钥空间不变，组成主机端的更新的密钥空间。为了保证密
		<br/>钥空间更新的安全性，主机端还可以在进行异或运算之前备份现有的密钥空
		<br/>间，并且在密钥更新完成后释放备份的密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_107"><p id="p0107" num="0107">步骤202，主机端将随机数R2发送到设备端。
		<br/>
			</p></td></tr><tr><td class="content" id="description_108"><p id="p0108" num="0108">步骤203，设备端收到随机数R2，采用与步骤201中主机端相同的方
		<br/>
				法，根据R2更新密钥空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_109"><p id="p0109" num="0109">步骤204，设备端向主机端返回状态字，报告密钥空间更新完成。
		<br/>
			</p></td></tr><tr><td class="content" id="description_110"><p id="p0110" num="0110">步骤201至步骤204完成了主机端与设备端的密钥空间更新，在完成双
		<br/>方的密钥空间更新后，双方以更新的密钥空间为基础进行数据传输，从而在
		<br/>之后的数据传输中更新密钥和安全算法，数据传输的详细步骤如下：
		<br/>
			</p></td></tr><tr><td class="content" id="description_111"><p id="p0111" num="0111">步骤205，主机端收到状态字后向设备端发送加密数据。
		<br/>
			</p></td></tr><tr><td class="content" id="description_112"><p id="p0112" num="0112">步骤206，设备端收到加密数据，采用与步骤205中主机端相同的方法，
		<br/>根据命令头确定解密所用的密钥，并根据该密钥确定安全算法，用该密钥和
		<br/>安全算法对数据域进行解密。
		<br/>
			</p></td></tr><tr><td class="content" id="description_113"><p id="p0113" num="0113">步骤207，设备端向主机端返回状态字，报告数据域解密完成。
		<br/>
			</p></td></tr><tr><td class="content" id="description_114"><p id="p0114" num="0114">步骤208，主机端收到状态字后判断密钥空间更新条件是否满足，当密
		<br/>钥空间更新条件满足时，返回步骤201，更新密钥空间；当密钥空间更新条
		<br/>件不满足时，返回步骤205，再次发送加密数据。
		<br/>
			</p></td></tr><tr><td class="content" id="description_115"><p id="p0115" num="0115">步骤205至步骤208与实施例1中的步骤105至步骤108相同，在此不
		<br/>再赘述。
		<br/>
			</p></td></tr><tr><td class="content" id="description_116"><p id="p0116" num="0116">由实施例2的以上步骤可以看出，通过以计算生成的密钥替代原有对称
		<br/>密钥更新密钥空间，数据传输的密钥在密钥空间中选择，并且根据数据传输
		<br/>的密钥选择安全算法，因此，当密钥空间更新后，数据传输所用密钥和安全
		<br/>算法同时更新，提高了数据传输的安全性。
		<br/>
			</p></td></tr><tr><td class="content" id="description_117"><p id="p0117" num="0117">实施例3：更新安全算法空间的数据加密传输方法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_118"><p id="p0118" num="0118">本实施例中的更新安全算法空间不改变设备生产时写入安全算法存储
		<br/>器中的安全算法，而是从安全算法寄存器中重新抽取安全算法组成新的安全
		<br/>算法空间，因此更新安全算法空间包括两种情况，一是至少改变安全算法空
		<br/>间中的一个安全算法；二是不改变安全算法空间中的安全算法，但是改变安
		<br/>全算法的排列顺序。
		<br/>
			</p></td></tr><tr><td class="content" id="description_119"><p id="p0119" num="0119">图3为更新安全算法空间的数据加密传输方法的信令流程图，参见图3，
		<br/>该方法包括以下步骤：
		<br/>
			</p></td></tr><tr><td class="content" id="description_120"><p id="p0120" num="0120">步骤301，主机端判断安全算法空间更新条件是否满足，当安全算法空
		<br/>间更新条件满足时，主机端产生随机数R3，根据R3更新安全算法空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_121"><p id="p0121" num="0121">此步骤中，根据R3更新安全算法空间的方法很多，此处仅以以下方法
		<br/>为例，也可以采用其它的方法根据R3更新安全算法空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_122"><p id="p0122" num="0122">只更新对称安全算法空间，非对称安全算法空间保持不变，由更新的对
		<br/>称安全算法空间和保持不变非对称安全算法空间组成更新的安全算法空间。
		<br/>更新对称安全算法空间的方法与实施例1步骤101中更新密钥空间的方法相
		<br/>同，具体是：将更新前已建立的对称安全算法空间中对称安全算法的个数记
		<br/>为M，配置M种对称安全算法空间生成方式，分别以0至M-1为上述M种
		<br/>对称安全算法空间生成方式编号，令随机数R3模M，R3模M的结果为0
		<br/>至M-1中的一个值，选择与R3模M的结果相同编号的安全算法空间生成
		<br/>方式，将该安全算法空间生成方式生成的安全算法空间确定为更新的安全算
		<br/>法空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_123"><p id="p0123" num="0123">步骤302，主机端将随机数R3发送到设备端。
		<br/>
			</p></td></tr><tr><td class="content" id="description_124"><p id="p0124" num="0124">步骤303，设备端收到随机数R3，采用与步骤301中主机端相同的方
		<br/>法，根据R3更新安全算法空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_125"><p id="p0125" num="0125">步骤304，设备端向主机端返回状态字，报告安全算法空间更新完成。
		<br/>
			</p></td></tr><tr><td class="content" id="description_126"><p id="p0126" num="0126">步骤301至步骤304完成了主机端与设备端的安全算法空间更新，在完
		<br/>成双方的安全算法空间更新后，双方以更新的安全算法空间为基础进行数据
		<br/>传输，从而在之后的数据传输中更新安全算法，数据传输的详细步骤如下：
		<br/>
			</p></td></tr><tr><td class="content" id="description_127"><p id="p0127" num="0127">步骤305，主机端收到状态字后向设备端发送加密数据。
		<br/>
			</p></td></tr><tr><td class="content" id="description_128"><p id="p0128" num="0128">此步骤与实施例1中的步骤105相同，在此步骤中，当前数据传输加密
		<br/>所用安全算法在步骤301更新的安全算法空间中确定。
		<br/>
			</p></td></tr><tr><td class="content" id="description_129"><p id="p0129" num="0129">步骤306，设备端收到加密数据，采用与步骤305中主机端相同的方法，
		<br/>根据命令头确定解密所用的密钥，并根据该密钥确定安全算法，并用该密钥
		<br/>和安全算法对数据域进行解密。
		<br/>
			</p></td></tr><tr><td class="content" id="description_130"><p id="p0130" num="0130">步骤307，设备端向主机端返回状态字，报告数据域解密完成。
		<br/>
			</p></td></tr><tr><td class="content" id="description_131"><p id="p0131" num="0131">步骤308，主机端收到状态字后判断安全算法空间更新条件是否满足，
		<br/>当安全算法空间更新条件满足时，返回步骤301，更新安全算法空间；当安
		<br/>全算法空间更新条件不满足时，返回步骤305，再次发送加密数据。主机端
		<br/>继续发送加密数据，直到安全算法空间更新条件满足。
		<br/>
			</p></td></tr><tr><td class="content" id="description_132"><p id="p0132" num="0132">由实施例3的以上步骤可以看出，通过在安全算法寄存器中重新抽取安
		<br/>全算法更新安全算法空间，数据传输的安全算法在更新的安全算法空间中选
		<br/>择，因此数据传输所用的安全算法更新，提高了数据传输的安全性。
		<br/>
			</p></td></tr><tr><td class="content" id="description_133"><p id="p0133" num="0133">上述三个实施例通过更新密钥空间或安全算法空间来更新当前数据传
		<br/>输所用的密钥或安全算法，还可以不更新密钥空间和安全算法空间，直接更
		<br/>新当前数据传输所用的安全算法，以下通过实施例4详细说明。
		<br/>
			</p></td></tr><tr><td class="content" id="description_134"><p id="p0134" num="0134">实施例4：更新当前数据传输安全算法的数据加密传输方法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_135"><p id="p0135" num="0135">本实施例不改变密钥空间和安全算法空间，只是在安全算法空间中重新
		<br/>选择安全算法作为当前数据传输的安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_136"><p id="p0136" num="0136">图4为更新安全算法的数据加密传输方法的信令流程图，参见图4，该
		<br/>方法包括以下步骤：
		<br/>
			</p></td></tr><tr><td class="content" id="description_137"><p id="p0137" num="0137">步骤401，主机端判断安全算法更新条件是否满足，当安全算法更新条
		<br/>件满足时，主机端产生随机数R4，根据R4更新安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_138"><p id="p0138" num="0138">此步骤中，根据R4更新安全算法的方法很多，此处仅以以下方法为例。
		<br/>
			</p></td></tr><tr><td class="content" id="description_139"><p id="p0139" num="0139">将安全算法空间中对称安全算法的个数记为M，令随机数R4模M，R4
		<br/>模M的结果为0至M-1中的一个值，根据预先配置的安全算法抽取方式在
		<br/>对称安全算法空间中抽取与R4模M的结果对应的安全算法，将其确定为更
		<br/>新的安全算法。例如，一个包含10个对称安全算法的安全算法空间，则
		<br/>M＝10，预先配置的安全算法抽取方式为依次抽取，如果R4模M的结果等
		<br/>于2，则抽取安全算法空间中第2个安全算法作为当前数据传输的安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_140"><p id="p0140" num="0140">步骤402，主机端将随机数R4发送到设备端。
		<br/>
			</p></td></tr><tr><td class="content" id="description_141"><p id="p0141" num="0141">步骤403，设备端收到随机数R4，采用与步骤401中主机端相同的方
		<br/>法，根据R4更新安全算法。
		<br/>
			</p></td></tr><tr><td class="content" id="description_142"><p id="p0142" num="0142">步骤404，设备端向主机端返回状态字，报告安全算法更新完成。
		<br/>
			</p></td></tr><tr><td class="content" id="description_143"><p id="p0143" num="0143">步骤401至步骤404完成了主机端与设备端的安全算法更新，在完成双
		<br/>方的安全算法更新后，双方以更新的安全算法进行数据传输，数据传输的详
		<br/>细步骤如下：
		<br/>
			</p></td></tr><tr><td class="content" id="description_144"><p id="p0144" num="0144">步骤405，主机端收到状态字后向设备端发送加密数据。
		<br/>
			</p></td></tr><tr><td class="content" id="description_145"><p id="p0145" num="0145">此步骤中，主机端发送的加密数据由命令头和数据域组成，主机端根据
		<br/>命令头确定当前数据传输加密所用的密钥，将步骤401中更新的安全算法确
		<br/>定为当前数据传输所用的安全算法，采用该密钥和安全算法对明文数据进行
		<br/>加密后写入数据域。
		<br/>
			</p></td></tr><tr><td class="content" id="description_146"><p id="p0146" num="0146">根据命令头确定当前数据传输加密所用密钥的方法是：将密钥空间中对
		<br/>称密钥的个数记为N1，用命令头模N1，按照预先配置的密钥抽取方式，根
		<br/>据命令头模N1的结果在对称密钥空间中抽取出一个密钥作为当前数据传输
		<br/>的密钥。
		<br/>
			</p></td></tr><tr><td class="content" id="description_147"><p id="p0147" num="0147">步骤406，设备端收到加密数据，采用与步骤405中主机端相同的方法，
		<br/>根据命令头确定解密所用的密钥，并采用该密钥和步骤403中更新的安全算
		<br/>法对数据域进行解密。
		<br/>
			</p></td></tr><tr><td class="content" id="description_148"><p id="p0148" num="0148">步骤407，设备端向主机端返回状态字，报告数据域解密完成。
		<br/>
			</p></td></tr><tr><td class="content" id="description_149"><p id="p0149" num="0149">步骤408，主机端收到状态字后判断安全算法更新条件是否满足，当安
		<br/>全算法更新条件满足时，返回步骤401，更新安全算法；当安全算法更新条
		<br/>件不满足时，返回步骤405，再次发送加密数据。主机端继续发送加密数据，
		<br/>直到安全算法更新条件满足。
		<br/>
			</p></td></tr><tr><td class="content" id="description_150"><p id="p0150" num="0150">由实施例4的以上步骤可以看出，通过在安全算法空间中重新抽取安全
		<br/>算法，更新当前数据传输的安全算法，提高了数据传输的安全性。
		<br/>
			</p></td></tr><tr><td class="content" id="description_151"><p id="p0151" num="0151">以上四个具体实施例分别说明了通过更新密钥空间、更新安全算法空间
		<br/>或直接更新安全算法的数据加密传输方法，在数据传输中还可以将上述四个
		<br/>实施例组合使用，则在上述4个实施例的步骤101、步骤108、步骤201、
		<br/>步骤208、步骤301、步骤308、步骤401和步骤408中，控制端随时判断
		<br/>
				密钥空间更新条件、安全算法空间更新条件和安全算法更新条件是否满足，
		<br/>当其中一种或多种更新条件满足时，采用上述对应的实施例中所述的方法进
		<br/>行更新，存在一种或多种更新同时进行或交替进行的情况。
		<br/>
			</p></td></tr><tr><td class="content" id="description_152"><p id="p0152" num="0152">以上介绍了本发明提出的数据加密传输方法，下面以一个实施例说明采
		<br/>用该方法的数据加密传输装置。图5为本发明一较佳实施例数据加密传输装
		<br/>置的结构图。如图5所示，本实施例中数据加密传输装置包括：接收单元
		<br/>501、解密单元502、发送单元503、加密单元504、密钥寄存器505、密钥
		<br/>空间存储单元506、安全算法寄存器507、安全算法空间存储单元508和控
		<br/>制单元509。
		<br/>
			</p></td></tr><tr><td class="content" id="description_153"><p id="p0153" num="0153">密钥寄存器505用于存储所有密钥，密钥空间存储单元506用于存储密
		<br/>钥空间。安全算法寄存器507用于存储所有安全算法，安全算法空间存储单
		<br/>元508用于存储安全算法空间。
		<br/>
			</p></td></tr><tr><td class="content" id="description_154"><p id="p0154" num="0154">控制单元509从密钥寄存器505中抽取密钥复制到密钥空间存储单元
		<br/>506中，建立或更新密钥空间；从安全算法寄存器507中抽取安全算法复制
		<br/>到安全算法空间存储单元508中，建立或更新安全算法空间。控制单元设置
		<br/>密钥空间更新条件、安全算法空间更新条件和安全算法更新条件，并判断上
		<br/>述更新条件是否满足。当密钥空间更新条件满足时，控制单元509采用如上
		<br/>述实施例1或2所述的方法更新密钥空间；当安全算法空间更新条件满足时，
		<br/>控制单元509采用如上述实施例3所述的方法更新安全算法空间；当安全算
		<br/>法更新条件满足时，控制单元509采用如上述实施例4所述的方法更新安全
		<br/>算法。控制单元509基于更新的密钥空间或安全算法空间或安全算法确定数
		<br/>据传输密钥和安全算法，并将其提供给解密单元502和加密单元504。
		<br/>
			</p></td></tr><tr><td class="content" id="description_155"><p id="p0155" num="0155">接收单元501接收对方数据传输装置的加密数据并将其传送给解密单元
		<br/>502。解密单元502根据控制单元509提供的数据传输密钥和安全算法对接
		<br/>收单元501提供的加密数据进行解密。
		<br/>
			</p></td></tr><tr><td class="content" id="description_156"><p id="p0156" num="0156">加密单元504根据控制单元509提供的数据传输密钥和安全算法对明文
		<br/>数据进行加密，并将加密数据传送给发送单元503，发送单元503将加密数
		<br/>
				据发送给对方数据传输装置。
		<br/>
			</p></td></tr><tr><td class="content" id="description_157"><p id="p0157" num="0157">在本实施例中，密钥空间和安全算法空间存储于在数据加密传输装置中
		<br/>的物理存储单元，也可以采用对从密钥寄存器和安全算法寄存器中抽取出的
		<br/>密钥和安全算法进行标记的方法组成密钥空间和安全算法空间，则在数据加
		<br/>密传输装置中不需包含图5所示的密钥空间存储单元506和安全算法空间存
		<br/>储单元508。
		<br/>
			</p></td></tr><tr><td class="content" id="description_158"><p id="p0158" num="0158">由以上实施例可见，本发明实施例中在数据传输的双方均设置密钥空间
		<br/>和安全算法空间，并且分别为密钥空间、安全算法空间、安全算法设置更新
		<br/>条件。在数据传输时，分别从密钥空间和安全算法空间抽取当前数据传输的
		<br/>密钥和安全算法，利用密钥和安全算法将明文数据加密后进行传输。当对应
		<br/>更新条件满足时，同步更新数据传输双方的更新密钥空间、安全算法空间或
		<br/>安全算法，从而使得数据传输中使用的密钥和安全算法动态更新，不确定性
		<br/>增大，因而增强了数据传输的安全性。并且本发明实施例提出的密钥空间、
		<br/>安全算法空间和安全算法更新方法无需复杂运算，简单易行。
		<br/>
			</p></td></tr><tr><td class="content" id="description_159"><p id="p0159" num="0159">总之，以上所述仅为本发明的较佳实施例而已，并非用于限定本发明的保
		<br/>护范围。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，
		<br/>均应包含在本发明的保护范围之内。
		<br/>
			</p></td></tr></table></div></body></html>