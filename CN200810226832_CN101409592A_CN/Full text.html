<html><head><title>全文文本(Fulltext)</title><meta http-equiv='Content-Type' content='text/html; charset=UTF-8'><style>div.fullText table {width: 100%;text-indent: 1px;} 
 div.fullText table td.header {font-weight: bold;text-align: center;font-family: '宋体';font-size: 16px;line-height:20px;color: #000000;padding: 5px;}div.fullText table td.content {padding: 1px;text-align: left;vertical-align: top;width: 100%;font-family: '宋体';font-size: 14px;line-height:20px;color: #000000;}</style></head><body><?xml version="1.0" encoding="UTF-8"?><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" class="fullText"><table class="fullText"><tr><td id="claim_title" class="header">权利要求书</td></tr><tr><td class="content" id="claim_1">1、一种基于条件接收卡实现多应用业务的系统，其特征在于，该系统包括：
      <br/>条件接收CA卡管理代理CMA服务器、用户设备UE、CA卡以及一个以上运
      <br/>营商应用业务服务器，其中，
      <br/>
				</td></tr><tr><td class="content" id="claim_2">CMA服务器，根据来自UE的注册请求信息中包含的CA卡卡号和认证密
      <br/>钥，与该CA卡完成双向注册认证，将预先存储的运营商应用业务服务器应用
      <br/>业务列表信息发送至UE；根据返回的包含运营商应用业务服务器标识信息的应
      <br/>用业务程序请求信息，确认已注册认证后，向相应的运营商服务器发送；接收
      <br/>运营商服务器返回的应用业务程序请求响应信息，发送至相应的UE；
      <br/>
				</td></tr><tr><td class="content" id="claim_3">UE，用于在检测到CA卡复位后，通知CA卡与CMA服务器完成双向注
      <br/>册认证；接收运营商应用业务服务器应用业务列表信息，根据用户选择的运营
      <br/>商应用业务服务器应用业务列表，向CMA服务器返回应用业务程序请求信息；
      <br/>接收应用业务程序请求响应信息以及加密的应用业务程序，与CA卡使用安装
      <br/>密钥进行认证，认证通过后发送至CA卡；
      <br/>
				</td></tr><tr><td class="content" id="claim_4">运营商应用业务服务器，用于与CMA服务器交互，将自身应用业务列表
      <br/>信息发送至CMA服务器；接收CMA服务器发送的应用业务程序请求信息，将
      <br/>用户请求的运营商应用业务程序安装密钥和授权密钥信息包含在应用业务程序
      <br/>请求响应信息中，通过非业务信道发送至CMA服务器，将用户请求的运营商
      <br/>应用业务程序利用授权密钥加密后通过业务信道发送至相应的UE；
      <br/>
				</td></tr><tr><td class="content" id="claim_5">CA卡，用于接收UE的通知信息，完成与CMA服务器的注册认证；接收
      <br/>UE发送的应用业务程序请求响应信息以及应用业务程序，根据应用业务程序请
      <br/>求响应信息包含的授权密钥对加密的应用业务程序解密，并安装解密的应用业
      <br/>务程序。
      <br/>
				</td></tr><tr><td class="content" id="claim_6">2、一种条件接收卡管理代理服务器，其特征在于，包括：认证注册模块、
      <br/>应用业务处理模块、应用业务存储模块、条件接收卡注册信息存储模块，其中，
      <br/>
				</td></tr><tr><td class="content" id="claim_7">认证注册模块，用于根据来自用户设备的注册请求信息，根据预先存储的
      <br/>
					认证密钥与条件接收卡进行双向注册认证，注册认证通过后，通知应用业务处
      <br/>理模块，并将注册认证信息存储在条件接收卡注册信息存储模块；
      <br/>
				</td></tr><tr><td class="content" id="claim_8">应用业务处理模块，用于接收认证注册模块发送的通知，从应用业务存储
      <br/>模块读取运营商应用业务服务器应用业务列表信息发送至用户设备；
      <br/>
				</td></tr><tr><td class="content" id="claim_9">接收来自用户设备的应用业务程序请求信息，查询条件接收卡注册信息存
      <br/>储模块，确认该用户设备对应的条件接收卡已通过注册认证，根据应用业务程
      <br/>序请求信息包含的运营商应用业务服务器标识信息，向相应运营商应用业务服
      <br/>务器发送；
      <br/>
				</td></tr><tr><td class="content" id="claim_10">接收运营商服务器返回的应用业务程序请求响应信息，向用户设备发送；
      <br/>
				</td></tr><tr><td class="content" id="claim_11">应用业务存储模块，用于存储运营商应用业务服务器应用业务列表信息；
      <br/>
				</td></tr><tr><td class="content" id="claim_12">条件接收卡注册信息存储模块，用于存储条件接收卡注册信息。
      <br/>
				</td></tr><tr><td class="content" id="claim_13">3、如权利要求2所述的条件接收卡管理代理服务器，其特征在于，所述应
      <br/>用业务存储模块进一步用来存储应用业务程序安装密钥和授权密钥信息；
      <br/>
				</td></tr><tr><td class="content" id="claim_14">所述应用业务处理模块进一步用于根据运营商服务器返回的应用业务程序
      <br/>请求响应信息，如果确定应用业务程序请求响应信息不包含应用业务程序安装
      <br/>密钥和授权密钥信息，从所述应用业务存储模块获取所述应用业务程序对应的
      <br/>安装密钥和授权密钥信息，发送至用户设备。
      <br/>
				</td></tr><tr><td class="content" id="claim_15">4、一种条件接收卡，其特征在于，包括：应用管理模块、防火墙模块以及
      <br/>运营商安全域模块，其中，
      <br/>
				</td></tr><tr><td class="content" id="claim_16">应用管理模块，用于接收用户设备发送的通知信息，根据预先存储的认证
      <br/>密钥完成与条件接收卡管理代理服务器的注册认证并存储注册认证信息，接收
      <br/>用户设备发送的应用业务程序请求响应信息并存储，根据应用业务程序请求响
      <br/>应信息中包含的运营商应用业务服务器信息，建立运营商应用业务服务器与运
      <br/>营商安全域模块的映射关系，接收加密的应用业务程序，进行解密后安装该应
      <br/>用业务程序，并将解密后的应用业务程序存储在运营商安全域模块中；
      <br/>
				</td></tr><tr><td class="content" id="claim_17">防火墙模块，用于隔离应用管理模块与运营商安全域模块、以及隔离各运
      <br/>营商安全域模块；
      <br/>
					
				</td></tr><tr><td class="content" id="claim_18">运营商安全域模块，用于存储应用业务程序和应用数据。
      <br/>
				</td></tr><tr><td class="content" id="claim_19">5、一种基于条件接收卡实现多应用业务的方法，其特征在于，该方法包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_20">用户设备UE检测到条件接收CA卡复位后，通知CA卡与CA卡管理代理
      <br/>CMA服务器完成双向注册认证；
      <br/>
				</td></tr><tr><td class="content" id="claim_21">CMA服务器将预先存储的运营商应用业务服务器应用业务列表信息发送
      <br/>至UE；UE根据用户选择的运营商应用业务服务器应用业务列表，向CMA服
      <br/>务器返回应用业务程序请求信息；
      <br/>
				</td></tr><tr><td class="content" id="claim_22">CMA服务器根据返回的包含运营商应用业务服务器标识信息的应用业务
      <br/>程序请求信息，确认已注册认证，向相应的运营商服务器发送；
      <br/>
				</td></tr><tr><td class="content" id="claim_23">运营商应用业务服务器根据接收的应用业务程序请求信息，将用户请求的
      <br/>运营商应用业务程序安装密钥和授权密钥信息包含在应用业务程序请求响应信
      <br/>息中，通过CMA服务器发送至UE，将用户请求的运营商应用业务程序利用授
      <br/>权密钥加密后发送至相应的UE；
      <br/>
				</td></tr><tr><td class="content" id="claim_24">UE接收应用业务程序请求响应信息以及加密的应用业务程序，与CA卡使
      <br/>用安装密钥进行认证，认证通过后发送至CA卡，CA卡根据应用业务程序请求
      <br/>响应信息包含的授权密钥对加密的应用业务程序解密，安装解密的应用业务程
      <br/>序。
      <br/>
				</td></tr><tr><td class="content" id="claim_25">6、如权利要求5所述的方法，其特征在于，所述UE从非业务通道接收应
      <br/>用业务程序请求响应信息；从业务通道接收加密的应用业务程序。
      <br/>
				</td></tr><tr><td class="content" id="claim_26">7、如权利要求6所述的方法，其特征在于，所述非业务通道包括移动通信
      <br/>网络或互联网络，所述业务通道包括广播通信网络。
      <br/>
				</td></tr><tr><td class="content" id="claim_27">8、如权利要求5所述的方法，其特征在于，进一步包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_28">运营商应用业务服务器通过CMA服务器向UE发送批量更新应用业务程序
      <br/>请求信息；
      <br/>
				</td></tr><tr><td class="content" id="claim_29">UE接收批量更新应用业务程序请求信息，由用户选择需要更新的应用业务
      <br/>程序，将用户过滤处理后的批量更新应用业务程序请求信息发送至CA卡；
      <br/>
				</td></tr><tr><td class="content" id="claim_30">CA卡接收过滤后的批量更新应用业务程序请求信息，确定需要更新应用业
      <br/>
					务程序，通过UE向CMA服务器请求更新应用业务程序对应的授权密钥和安
      <br/>装密钥，运营商应用业务服务器通过业务信道下发批量更新的应用业务程序，
      <br/>UE接收到批量更新的应用业务程序后，过滤出用户选择安装的更新应用业务程
      <br/>序，然后与CA卡进行认证，认证通过后将应用业务程序发送至CA卡，CA卡
      <br/>解密应用业务程序，进行更新安装。
      <br/>
				</td></tr><tr><td class="content" id="claim_31">9、如权利要求8所述的方法，其特征在于，所述批量更新应用业务程序请
      <br/>求信息包括：运营商应用业务服务器标识、更新的应用业务程序标识列表及对
      <br/>应的加扰密钥、以及更新应用业务程序的大小。
      <br/>
				</td></tr><tr><td class="content" id="claim_32">10、如权利要求9所述的方法，其特征在于，所述确定需要更新应用业务
      <br/>程序的步骤具体包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_33">CA卡根据接收的批量更新应用业务程序请求信息，查询运营商应用业务服
      <br/>务器标识是否与自身应用管理模块存储的运营商应用业务服务器标识一致，对
      <br/>应的应用业务程序是否存在，以及对应的自身运营商安全域存储空间是否满足，
      <br/>如果均满足，向UE返回批量更新应用业务请求响应信息，包含自身需要更新
      <br/>的应用业务程序标识列表信息。
      <br/>
				</td></tr><tr><td class="content" id="claim_34">11、如权利要求10所述的方法，其特征在于，确定所述对应的自身运营商
      <br/>安全域存储空间是否满足的步骤进一步包括：如果是对应的该运营商安全域存
      <br/>储空间不满足，则根据用户默认的设置或与用户交互，删除其它应用业务程序
      <br/>后判断存储空间是否足够。
      <br/>
				</td></tr><tr><td class="content" id="claim_35">12、如权利要求5所述的方法，其特征在于，进一步包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_36">运营商应用业务服务器确定CA卡定制的应用业务程序需要更新，通过
      <br/>CMA服务器、UE向CA卡发送更新定制应用业务请求信息；
      <br/>
				</td></tr><tr><td class="content" id="claim_37">CA卡接收更新定制应用业务程序请求信息，确定更新定制应用业务程序对
      <br/>应的自身运营商安全域存储空间满足，通过UE、CMA服务器向运营商应用业
      <br/>务服务器返回更新定制应用业务程序请求响应信息；
      <br/>
				</td></tr><tr><td class="content" id="claim_38">运营商应用业务服务器接收更新定制应用业务程序请求响应信息，通过业
      <br/>务通道向相应的UE发送用户定制的应用业务更新程序；
      <br/>
					
				</td></tr><tr><td class="content" id="claim_39">UE从业务通道接收加密的应用业务更新程序，然后与CA卡使用安装密钥
      <br/>进行认证，认证通过后，将应用业务程序发送到CA卡内，CA卡接收应用业务
      <br/>更新程序，进行解密，更新自身存储的相应信息，并安装应用业务更新程序。
      <br/>
				</td></tr><tr><td class="content" id="claim_40">13、如权利要求5或8所述的方法，其特征在于，进一步包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_41">UE接收切换请求，向应用管理模块发送包含运营商应用业务服务器标识以
      <br/>及用户识别号码的应用协议数据单元的第一访问权限请求信息；
      <br/>
				</td></tr><tr><td class="content" id="claim_42">应用管理模块接收第一访问权限请求信息，验证用户识别号码，如果确定
      <br/>验证通过，向UE返回第一访问权限请求成功信息，UE接收并向应用管理模块
      <br/>发送包含应用标识符和二级用户识别号码的第二访问权限请求信息；
      <br/>
				</td></tr><tr><td class="content" id="claim_43">应用管理模块接收第二访问权限请求信息，验证二级用户识别号码，如果
      <br/>验证通过，向UE返回第二访问权限请求成功信息；
      <br/>
				</td></tr><tr><td class="content" id="claim_44">应用管理模块查询切换的应用业务所在运营商安全域的地址，建立与UE
      <br/>的通道并切换至应用业务。
      <br/>
				</td></tr><tr><td class="content" id="claim_45">14、如权利要求13所述的方法，其特征在于，所述切换的方式包括：基于
      <br/>中断模式的多应用业务切换处理、基于时间片模式的多应用业务交叉切换处理
      <br/>以及基于混合模式的多应用业务切换处理。
      <br/>
				</td></tr><tr><td class="content" id="claim_46">15、如权利要求14所述的方法，其特征在于，所述基于中断模式的多应用
      <br/>业务切换处理的步骤具体包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_47">CA卡应用管理模块执行预先设置的默认应用业务；
      <br/>
				</td></tr><tr><td class="content" id="claim_48">UE接收用户切换请求，向应用管理模块发送认证请求；
      <br/>
				</td></tr><tr><td class="content" id="claim_49">应用管理模块保存默认应用业务上下文信息，与UE进行认证，认证通过
      <br/>后为切换请求对应的应用业务建立通道，执行所述切换请求对应的应用业务。
      <br/>
				</td></tr><tr><td class="content" id="claim_50">16、如权利要求15所述的方法，其特征在于，所述认证通过后为切换请求
      <br/>对应的应用业务建立通道，执行所述切换请求对应的应用业务的步骤具体包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_51">应用管理模块接收认证请求，如果默认应用业务与切换请求对应的应用业
      <br/>务属于同一运营商安全域，则与UE执行运营商安全域中应用业务访问权限的
      <br/>验证，认证通过后利用为默认应用业务分配的资源执行所述切换请求对应的应
      <br/>
					用业务；
      <br/>
				</td></tr><tr><td class="content" id="claim_52">如果默认应用业务与切换请求对应的应用业务不属于同一运营商安全域，
      <br/>则与UE执行运营商安全域的访问权限的验证、以及运营商安全域中应用业务
      <br/>访问权限的验证，认证通过后为切换请求对应的应用业务2分配资源，建立与
      <br/>UE的通道并执行所述切换请求对应的应用业务。
      <br/>
				</td></tr><tr><td class="content" id="claim_53">17、如权利要求14所述的方法，其特征在于，所述基于时间片模式的多应
      <br/>用业务交叉切换处理的步骤具体包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_54">CA卡应用管理模块为默认应用业务以及切换请求对应的应用业务分别分
      <br/>配时间片，
      <br/>
				</td></tr><tr><td class="content" id="claim_55">CA卡应用管理模块根据当前时间片信息执行对应的应用业务，在当前时间
      <br/>片时间到时，存储当前应用业务上下文信息，读取下一时间片信息对应的应用
      <br/>业务上下文信息并执行该应用业务。
      <br/>
				</td></tr><tr><td class="content" id="claim_56">18、如权利要求14所述的方法，其特征在于，所述基于混合模式的多应用
      <br/>业务切换处理的步骤具体包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_57">CA卡应用管理模块确定需要执行的应用业务，执行所述需要执行的应用业
      <br/>务的公共应用业务；
      <br/>
				</td></tr><tr><td class="content" id="claim_58">所述公共应用业务执行完毕，存储公共应用业务上下文信息，以中断模式
      <br/>或时间片模式执行所述需要执行的应用业务除公共应用业务外的部分。
      <br/>
				</td></tr><tr><td class="content" id="claim_59">19、如权利要求5所述的方法，其特征在于，进一步包括：
      <br/>
				</td></tr><tr><td class="content" id="claim_60">CMA服务器通过专用网络与运营商应用业务服务器交互，接收运营商应用
      <br/>业务服务器发送的自身应用业务列表信息并存储，相应地，
      <br/>
				</td></tr><tr><td class="content" id="claim_61">运营商应用业务服务器根据接收的应用业务程序请求信息，向CMA服务
      <br/>器发送应用业务程序请求响应信息，将用户请求的运营商应用业务程序利用授
      <br/>权密钥加密后发送至相应的UE；
      <br/>
				</td></tr><tr><td class="content" id="claim_62">CMA服务器根据接收的应用业务程序请求响应信息，查询获取应用业务程
      <br/>序对应的安装密钥和授权密钥信息，携带在应用业务程序请求响应信息中，发
      <br/>送至UE。
      <br/>
					
				</td></tr><tr><td class="content" id="claim_63">20、如权利要求19所述的方法，其特征在于，所述运营商应用业务服务器
      <br/>应用业务列表信息包含：运营商应用业务服务器列表信息和运营商应用业务服
      <br/>务器对应的应用业务列表信息。
      <br/>
					
				</td></tr></table></div><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" class="fullText"><table><tr><td id="description_title" class="header">说明书</td></tr><tr><td class="content" id="description_invention_title">一种基于条件接收卡实现多应用业务的方法、系统及装置
  </td></tr><tr><td class="content" id="description_1">技术领域
  </td></tr><tr><td class="content" id="description_2">本发明涉及通信系统条件接收(CA，Conditional Access)技术，特别
    涉及一种基于条件接收卡实现多应用业务的方法、系统及装置。
    
				</td></tr><tr><td class="content" id="description_3">背景技术
  </td></tr><tr><td class="content" id="description_4">目前，智能卡(IC，Intelligent Card)应用的领域越来越广泛，涉及的
    行业也多种多样，并以其安全、小巧等优势越来越受到各行各业的青睐。CA
    卡作为智能卡的一种，是具有条件接收功能的智能卡，主要应用在数字电视
    领域的数字电视条件接收业务。例如，在现今流行的数字电视行业中，大部
    分手机厂家采用基于智能卡接口的CA卡系统方案来实现数字电视的接收，
    该系统方案通过内嵌一颗智能卡芯片来完成认证、鉴权等功能。
    
				</td></tr><tr><td class="content" id="description_5">图1为现有CA卡系统结构示意图，参见图1，该系统主要包括：运营
    商应用业务服务器、CA卡管理器、CA卡读卡器、CA卡、用户设备(UE，
    User Equipment)，
    
				</td></tr><tr><td class="content" id="description_6">CA卡管理器，用于负责发放CA卡、CA卡认证、鉴权、CA卡应用更
    新、CA卡的管理和维护；
    
				</td></tr><tr><td class="content" id="description_7">每个CA卡管理系统对应一个运营商应用业务服务器，负责管理和维护
    与相应运营商业务相关的CA卡。
    
				</td></tr><tr><td class="content" id="description_8">运营商应用业务服务器，用于与CA卡管理系统交互，共同执行对CA
    卡的认证、鉴权、应用更新、管理和维护，并通过单向的业务通道，如广播
    通信网络下发业务信息，通过非业务通道，如移动通信网络、互联网络下发
    应用信息，该应用信息为业务对应的应用程序安装信息。
    
				</td></tr><tr><td class="content" id="description_9">CA卡读卡器，用于插入CA卡，CA卡读卡器与个人计算机相连，对
    
					CA卡进行离线操作；
    
				</td></tr><tr><td class="content" id="description_10">用户设备，用于插入CA卡，对CA卡进行在线操作：用户设备通过非
    业务通道如移动通信网络与CA卡管理系统交互获取应用信息、以及通过业
    务通道接收运营商应用业务服务器下发的业务信息。
    
				</td></tr><tr><td class="content" id="description_11">由上述可见，现有的CA卡系统，在系统架构和软件基础上都只是针对
    单个运营商，每个运营商针对自身的需要设计CA卡，并对自身提供的CA
    卡进行管理和维护。随着数字电视技术和应用的不断深入和发展，多运营商
    共同运营、行业间交叉结合，给用户提供多样化业务和高质量服务，是未来
    发展的趋势，而现有的CA卡系统只能支持单运营商的业务，用户不能在提
    供不同业务、不同服务质量的多个运营商之间进行切换，例如，假设有多家
    运营商提供数字电视业务，由于各个运营商提供的节目可能不同，则用户需
    要分别购买各运营商提供的CA卡才能收看相应运营商提供的数字电视业务
    节目，不仅增加了用户的成本，也造成用户携带和使用CA卡时的不方便，
    因而不能满足用户日益增长的多样化业务和高质量服务的需求。
    
				</td></tr><tr><td class="content" id="description_12">发明内容
  </td></tr><tr><td class="content" id="description_13">有鉴于此，本发明的一个主要目的在于提供一种基于条件接收卡实现多
    应用业务的装置，支持多运营商的业务，满足用户多样化业务和高质量服务
    的需求。
    
				</td></tr><tr><td class="content" id="description_14">本发明的另一个主要目的在于提供一种基于条件接收卡实现多应用业
    务的系统，支持多运营商的业务，满足用户多样化业务和高质量服务的需求。
    
				</td></tr><tr><td class="content" id="description_15">本发明的再一个主要目的在于提供一种基于条件接收卡实现多应用业
    务的方法，支持多运营商的业务，满足用户多样化业务和高质量服务的需求。
    
				</td></tr><tr><td class="content" id="description_16">为达到上述目的，本发明提供了一种基于条件接收卡实现多应用业务的
    系统，其特征在于，该系统包括：条件接收CA卡管理代理CMA服务器、
    用户设备UE、CA卡以及一个以上运营商应用业务服务器，其中，
    
				</td></tr><tr><td class="content" id="description_17">CMA服务器，根据来自UE的注册请求信息中包含的CA卡卡号和认证密
    
					钥，与该CA卡完成双向注册认证，将预先存储的运营商应用业务服务器应用
    业务列表信息发送至UE；根据返回的包含运营商应用业务服务器标识信息的应
    用业务程序请求信息，确认已注册认证后，向相应的运营商服务器发送；接收
    运营商服务器返回的应用业务程序请求响应信息，发送至相应的UE；
    
				</td></tr><tr><td class="content" id="description_18">UE，用于在检测到CA卡复位后，通知CA卡与CMA服务器完成双向注
    册认证；接收运营商应用业务服务器应用业务列表信息，根据用户选择的运营
    商应用业务服务器应用业务列表，向CMA服务器返回应用业务程序请求信息；
    接收应用业务程序请求响应信息以及加密的应用业务程序，与CA卡使用安装
    密钥进行认证，认证通过后发送至CA卡；
    
				</td></tr><tr><td class="content" id="description_19">运营商应用业务服务器，用于与CMA服务器交互，将自身应用业务列表
    信息发送至CMA服务器；接收CMA服务器发送的应用业务程序请求信息，将
    用户请求的运营商应用业务程序安装密钥和授权密钥信息包含在应用业务程序
    请求响应信息中，通过非业务信道发送至CMA服务器，将用户请求的运营商
    应用业务程序利用授权密钥加密后通过业务信道发送至相应的UE；
    
				</td></tr><tr><td class="content" id="description_20">CA卡，用于接收UE的通知信息，完成与CMA服务器的注册认证；
    接收UE发送的应用业务程序请求响应信息以及应用业务程序，根据应用业
    务程序请求响应信息包含的授权密钥对加密的应用业务程序解密，并安装解
    密的应用业务程序。
    
				</td></tr><tr><td class="content" id="description_21">一种条件接收卡管理代理服务器，包括：认证注册模块、应用业务处理
    模块、应用业务存储模块、条件接收卡注册信息存储模块，其中，
    
				</td></tr><tr><td class="content" id="description_22">认证注册模块，用于根据来自用户设备的注册请求信息，根据预先存储的
    认证密钥与条件接收卡进行双向注册认证，注册认证通过后，通知应用业务处
    理模块，并将注册认证信息存储在条件接收卡注册信息存储模块；
    
				</td></tr><tr><td class="content" id="description_23">应用业务处理模块，用于接收认证注册模块发送的通知，从应用业务存储
    模块读取运营商应用业务服务器应用业务列表信息发送至用户设备；
    
				</td></tr><tr><td class="content" id="description_24">接收来自用户设备的应用业务程序请求信息，查询条件接收卡注册信息存
    储模块，确认该用户设备对应的条件接收卡已通过注册认证，根据应用业务程
    
					序请求信息包含的运营商应用业务服务器标识信息，向相应运营商应用业务服
    务器发送；
    
				</td></tr><tr><td class="content" id="description_25">接收运营商服务器返回的应用业务程序请求响应信息，向用户设备发送；
    
				</td></tr><tr><td class="content" id="description_26">应用业务存储模块，用于存储运营商应用业务服务器应用业务列表信息；
    
				</td></tr><tr><td class="content" id="description_27">条件接收卡注册信息存储模块，用于存储条件接收卡注册信息。
    
				</td></tr><tr><td class="content" id="description_28">所述应用业务存储模块进一步用来存储应用业务程序安装密钥和授权密钥
    信息；
    
				</td></tr><tr><td class="content" id="description_29">所述应用业务处理模块进一步用于根据运营商服务器返回的应用业务程序
    请求响应信息，如果确定应用业务程序请求响应信息不包含应用业务程序安装
    密钥和授权密钥信息，从所述应用业务存储模块获取所述应用业务程序对应的
    安装密钥和授权密钥信息，发送至用户设备。
    
				</td></tr><tr><td class="content" id="description_30">一种条件接收卡，包括：应用管理模块、防火墙模块以及运营商安全域模
    块，其中，
    
				</td></tr><tr><td class="content" id="description_31">应用管理模块，用于接收用户设备发送的通知信息，根据预先存储的认证
    密钥完成与条件接收卡管理代理服务器的注册认证并存储注册认证信息，接收
    用户设备发送的应用业务程序请求响应信息并存储，根据应用业务程序请求响
    应信息中包含的运营商应用业务服务器信息，建立运营商应用业务服务器与运
    营商安全域模块的映射关系，接收加密的应用业务程序，进行解密后安装该应
    用业务程序，并将解密后的应用业务程序存储在运营商安全域模块中；
    
				</td></tr><tr><td class="content" id="description_32">防火墙模块，用于隔离应用管理模块与运营商安全域模块、以及隔离各运
    营商安全域模块；
    
				</td></tr><tr><td class="content" id="description_33">运营商安全域模块，用于存储应用业务程序和应用数据。
    
				</td></tr><tr><td class="content" id="description_34">一种基于条件接收卡实现多应用业务的方法，该方法包括：
    
				</td></tr><tr><td class="content" id="description_35">用户设备UE检测到条件接收CA卡复位后，通知CA卡与CA卡管理代理
    CMA服务器完成双向注册认证；
    
				</td></tr><tr><td class="content" id="description_36">CMA服务器将预先存储的运营商应用业务服务器应用业务列表信息发送
    至UE；UE根据用户选择的运营商应用业务服务器应用业务列表，向CMA服
    
					务器返回应用业务程序请求信息；
    
				</td></tr><tr><td class="content" id="description_37">CMA服务器根据返回的包含运营商应用业务服务器标识信息的应用业务
    程序请求信息，确认已注册认证，向相应的运营商服务器发送；
    
				</td></tr><tr><td class="content" id="description_38">运营商应用业务服务器根据接收的应用业务程序请求信息，将用户请求的
    运营商应用业务程序安装密钥和授权密钥信息包含在应用业务程序请求响应信
    息中，通过CMA服务器发送至UE，将用户请求的运营商应用业务程序利用授
    权密钥加密后发送至相应的UE；
    
				</td></tr><tr><td class="content" id="description_39">UE接收应用业务程序请求响应信息以及加密的应用业务程序，与CA卡使
    用安装密钥进行认证，认证通过后发送至CA卡，CA卡根据应用业务程序请求
    响应信息包含的授权密钥对加密的应用业务程序解密，安装解密的应用业务程
    序。
    
				</td></tr><tr><td class="content" id="description_40">所述UE从非业务通道接收应用业务程序请求响应信息；从业务通道接收
    加密的应用业务程序。
    
				</td></tr><tr><td class="content" id="description_41">所述非业务通道包括移动通信网络或互联网络，所述业务通道包括广播通
    信网络。
    
				</td></tr><tr><td class="content" id="description_42">进一步包括：
    
				</td></tr><tr><td class="content" id="description_43">运营商应用业务服务器通过CMA服务器向UE发送批量更新应用业务程序
    请求信息；
    
				</td></tr><tr><td class="content" id="description_44">UE接收批量更新应用业务程序请求信息，由用户选择需要更新的应用业务
    程序，将用户过滤处理后的批量更新应用业务程序请求信息发送至CA卡；
    
				</td></tr><tr><td class="content" id="description_45">CA卡接收过滤后的批量更新应用业务程序请求信息，确定需要更新应用业
    务程序，通过UE向CMA服务器请求更新应用业务程序对应的授权密钥和安
    装密钥，运营商应用业务服务器通过业务信道下发批量更新的应用业务程序，
    UE接收到批量更新的应用业务程序后，过滤出用户选择安装的更新应用业务程
    序，然后与CA卡进行认证，认证通过后将应用业务程序发送至CA卡，CA卡
    解密应用业务程序，进行更新安装。
    
				</td></tr><tr><td class="content" id="description_46">所述批量更新应用业务程序请求信息包括：运营商应用业务服务器标识、
    
					更新的应用业务程序标识列表及对应的加扰密钥、以及更新应用业务程序的大
    小。
    
				</td></tr><tr><td class="content" id="description_47">所述确定需要更新应用业务程序的步骤具体包括：
    
				</td></tr><tr><td class="content" id="description_48">CA卡根据接收的批量更新应用业务程序请求信息，查询运营商应用业务服
    务器标识是否与自身应用管理模块存储的运营商应用业务服务器标识一致，对
    应的应用业务程序是否存在，以及对应的自身运营商安全域存储空间是否满足，
    如果均满足，向UE返回批量更新应用业务请求响应信息，包含自身需要更新
    的应用业务程序标识列表信息。
    
				</td></tr><tr><td class="content" id="description_49">确定所述对应的自身运营商安全域存储空间是否满足的步骤进一步包括：
    如果是对应的该运营商安全域存储空间不满足，则根据用户默认的设置或与用
    户交互，删除其它应用业务程序后判断存储空间是否足够。
    
				</td></tr><tr><td class="content" id="description_50">进一步包括：
    
				</td></tr><tr><td class="content" id="description_51">运营商应用业务服务器确定CA卡定制的应用业务程序需要更新，通过
    CMA服务器、UE向CA卡发送更新定制应用业务请求信息；
    
				</td></tr><tr><td class="content" id="description_52">CA卡接收更新定制应用业务程序请求信息，确定更新定制应用业务程序对
    应的自身运营商安全域存储空间满足，通过UE、CMA服务器向运营商应用业
    务服务器返回更新定制应用业务程序请求响应信息；
    
				</td></tr><tr><td class="content" id="description_53">运营商应用业务服务器接收更新定制应用业务程序请求响应信息，通过业
    务通道向相应的UE发送用户定制的应用业务更新程序；
    
				</td></tr><tr><td class="content" id="description_54">UE从业务通道接收加密的应用业务更新程序，然后与CA卡使用安装密钥
    进行认证，认证通过后，将应用业务程序发送到CA卡内，CA卡接收应用业务
    更新程序，进行解密，更新自身存储的相应信息，并安装应用业务更新程序。
    
				</td></tr><tr><td class="content" id="description_55">进一步包括：
    
				</td></tr><tr><td class="content" id="description_56">UE接收切换请求，向应用管理模块发送包含运营商应用业务服务器标识以
    及用户识别号码的应用协议数据单元的第一访问权限请求信息；
    
				</td></tr><tr><td class="content" id="description_57">应用管理模块接收第一访问权限请求信息，验证用户识别号码，如果确定
    验证通过，向UE返回第一访问权限请求成功信息，UE接收并向应用管理模块
    
					发送包含应用标识符和二级用户识别号码的第二访问权限请求信息；
    
				</td></tr><tr><td class="content" id="description_58">应用管理模块接收第二访问权限请求信息，验证二级用户识别号码，如果
    验证通过，向UE返回第二访问权限请求成功信息；
    
				</td></tr><tr><td class="content" id="description_59">应用管理模块查询切换的应用业务所在运营商安全域的地址，建立与UE
    的通道并切换至应用业务。
    
				</td></tr><tr><td class="content" id="description_60">所述切换的方式包括：基于中断模式的多应用业务切换处理、基于时间片
    模式的多应用业务交叉切换处理以及基于混合模式的多应用业务切换处理。
    
				</td></tr><tr><td class="content" id="description_61">所述基于中断模式的多应用业务切换处理的步骤具体包括：
    
				</td></tr><tr><td class="content" id="description_62">CA卡应用管理模块执行预先设置的默认应用业务；
    
				</td></tr><tr><td class="content" id="description_63">UE接收用户切换请求，向应用管理模块发送认证请求；
    
				</td></tr><tr><td class="content" id="description_64">应用管理模块保存默认应用业务上下文信息，与UE进行认证，认证通过
    后为切换请求对应的应用业务建立通道，执行所述切换请求对应的应用业务。
    
				</td></tr><tr><td class="content" id="description_65">所述认证通过后为切换请求对应的应用业务建立通道，执行所述切换请求
    对应的应用业务的步骤具体包括：
    
				</td></tr><tr><td class="content" id="description_66">应用管理模块接收认证请求，如果默认应用业务与切换请求对应的应用业
    务属于同一运营商安全域，则与UE执行运营商安全域中应用业务访问权限的
    验证，认证通过后利用为默认应用业务分配的资源执行所述切换请求对应的应
    用业务；
    
				</td></tr><tr><td class="content" id="description_67">如果默认应用业务与切换请求对应的应用业务不属于同一运营商安全域，
    则与UE执行运营商安全域的访问权限的验证、以及运营商安全域中应用业务
    访问权限的验证，认证通过后为切换请求对应的应用业务2分配资源，建立与
    UE的通道并执行所述切换请求对应的应用业务。
    
				</td></tr><tr><td class="content" id="description_68">所述基于时间片模式的多应用业务交叉切换处理的步骤具体包括：
    
				</td></tr><tr><td class="content" id="description_69">CA卡应用管理模块为默认应用业务以及切换请求对应的应用业务分别分
    配时间片，
    
				</td></tr><tr><td class="content" id="description_70">CA卡应用管理模块根据当前时间片信息执行对应的应用业务，在当前时间
    片时间到时，存储当前应用业务上下文信息，读取下一时间片信息对应的应用
    
					业务上下文信息并执行该应用业务。
    
				</td></tr><tr><td class="content" id="description_71">所述基于混合模式的多应用业务切换处理的步骤具体包括：
    
				</td></tr><tr><td class="content" id="description_72">CA卡应用管理模块确定需要执行的应用业务，执行所述需要执行的应用业
    务的公共应用业务；
    
				</td></tr><tr><td class="content" id="description_73">所述公共应用业务执行完毕，存储公共应用业务上下文信息，以中断模式
    或时间片模式执行所述需要执行的应用业务除公共应用业务外的部分。
    
				</td></tr><tr><td class="content" id="description_74">进一步包括：
    
				</td></tr><tr><td class="content" id="description_75">CMA服务器通过专用网络与运营商应用业务服务器交互，接收运营商应用
    业务服务器发送的自身应用业务列表信息并存储，相应地，
    
				</td></tr><tr><td class="content" id="description_76">运营商应用业务服务器根据接收的应用业务程序请求信息，向CMA服务
    器发送应用业务程序请求响应信息，将用户请求的运营商应用业务程序利用授
    权密钥加密后发送至相应的UE；
    
				</td></tr><tr><td class="content" id="description_77">CMA服务器根据接收的应用业务程序请求响应信息，查询获取应用业务程
    序对应的安装密钥和授权密钥信息，携带在应用业务程序请求响应信息中，发
    送至UE。
    
				</td></tr><tr><td class="content" id="description_78">所述运营商应用业务服务器应用业务列表信息包含：运营商应用业务服务
    器列表信息和运营商应用业务服务器对应的应用业务列表信息。
    
				</td></tr><tr><td class="content" id="description_79">由上述的技术方案可见，本发明提供的一种基于条件接收卡实现多应用
    业务的方法、系统及装置，CMA服务器与CA卡完成双向注册认证后，将
    预先存储的运营商应用业务服务器应用业务列表信息发送至UE，用户选择
    自身需要的运营商应用业务服务器应用业务列表，然后，运营商应用业务服
    务器将用户选择的运营商应用业务程序安装密钥和授权密钥信息通过CMA
    服务器发送至UE，将用户选择的运营商应用业务程序加密后发送至相应的
    UE，UE接收后与CA卡使用安装密钥进行认证，认证通过后将业务程序发
    送至CA卡，CA卡使用授权密钥对加密的应用业务程序解密，安装解密的
    应用业务程序。通过将不同运营商提供的应用业务集中在CA卡上，实现了
    
					CA卡支持多运营商的应用业务的目的，满足了用户多样化业务和高质量服
    务的需求。
    
				</td></tr><tr><td class="content" id="description_80">附图说明
  </td></tr><tr><td class="content" id="description_81">图1为现有CA卡系统结构示意图；
    
				</td></tr><tr><td class="content" id="description_82">图2a为本发明基于条件接收卡实现多应用业务的系统结构示意图；
    
				</td></tr><tr><td class="content" id="description_83">图2b为本发明CMA服务器结构示意图；
    
				</td></tr><tr><td class="content" id="description_84">图2c为本发明CA卡结构示意图；
    
				</td></tr><tr><td class="content" id="description_85">图3为本发明基于条件接收卡实现多应用业务的注册认证应用业务流
    程示意图；
    
				</td></tr><tr><td class="content" id="description_86">图4为本发明基于条件接收卡实现多应用业务的批量应用业务程序更
    新流程示意图；
    
				</td></tr><tr><td class="content" id="description_87">图5为本发明基于条件接收卡实现多应用业务的定制应用业务程序更
    新流程示意图；
    
				</td></tr><tr><td class="content" id="description_88">图6为本发明CA卡中应用业务切换流程示意图；
    
				</td></tr><tr><td class="content" id="description_89">图7为本发明基于中断模式的多应用业务切换处理流程示意图；
    
				</td></tr><tr><td class="content" id="description_90">图8为本发明基于时间片模式的多业务交叉切换处理流程示意图；
    
				</td></tr><tr><td class="content" id="description_91">图9为本发明基于混合模式的多应用业务切换处理流程示意图。
    
				</td></tr><tr><td class="content" id="description_92">具体实施方式
  </td></tr><tr><td class="content" id="description_93">为使本发明的目的、技术方案和优点更加清楚，下面将结合附图及具体
    实施例对本发明作进一步地详细描述。
    
				</td></tr><tr><td class="content" id="description_94">本发明在现有的广播电视网、移动通信网络和CA卡系统(SOC，System
    on Chip)平台基础上，提出了一种能够支持跨多运营商、多业务的CA卡系
    统框架。该系统可以使不同运营商的多种业务同时运行在一张卡片上，并且
    运营商可以根据需求实时、动态的更新卡片服务。
    
				</td></tr><tr><td class="content" id="description_95">图2a为本发明基于条件接收卡实现多应用业务的系统结构示意图，参
    
					见图2a，该系统包括：CA卡管理代理(CMA，Card Management Agent)服
    务器、UE、CA卡以及运营商应用业务服务器，其中，
    
				</td></tr><tr><td class="content" id="description_96">CMA服务器通过专用网络与一个或多个运营商应用业务服务器相连、
    以及通过非业务通道与UE相连，一个或多个运营商应用业务服务器通过业
    务通道与UE相连。
    
				</td></tr><tr><td class="content" id="description_97">非业务通道包括但不限于移动通信网络、互联网络；业务通道包括但不
    限于广播通信网络。
    
				</td></tr><tr><td class="content" id="description_98">CMA服务器，根据来自UE的注册请求信息中包含的CA卡卡号和认
    证密钥，与该CA卡完成双向注册认证，将预先存储的运营商应用业务服务
    器应用业务列表信息发送至UE；根据返回的包含运营商应用业务服务器ID
    信息的应用业务程序请求信息，确认已注册认证后，向相应的运营商服务器
    发送；接收运营商服务器返回的应用业务程序请求响应信息，发送至相应的
    UE；
    
				</td></tr><tr><td class="content" id="description_99">UE，用于在检测到CA卡复位后，通知CA卡与CMA服务器完成双向
    注册认证；接收运营商应用业务服务器应用业务列表信息，根据用户选择的
    运营商应用业务服务器应用业务列表，向CMA服务器返回应用业务程序请
    求信息；接收应用业务程序请求响应信息以及加密的应用业务程序，利用应
    用业务程序响应信息包含的安装密钥与CA卡进行双向认证，认证通过后，
    将应用业务程序请求响应信息以及加密的应用业务程序发送至CA卡；
    
				</td></tr><tr><td class="content" id="description_100">运营商应用业务服务器，用于与CMA服务器交互，将自身应用业务列
    表信息发送至CMA服务器；接收CMA服务器发送的应用业务程序请求信
    息，将用户请求的运营商应用业务程序安装密钥和授权密钥信息包含在应用
    业务程序请求响应信息中，通过非业务信道发送至CMA服务器，将用户请
    求的运营商应用业务程序利用授权密钥加密后通过业务信道发送至相应的
    UE；
    
				</td></tr><tr><td class="content" id="description_101">CA卡，用于接收UE的通知信息，完成与CMA服务器的注册认证；
    接收UE发送的应用业务程序请求响应信息以及加密的应用业务程序，利用
    
					应用业务程序请求响应信息包含的授权密钥对加密的应用业务程序解密，并
    安装解密的应用业务程序。
    
				</td></tr><tr><td class="content" id="description_102">实际应用中，CMA服务器可以由运营商信任的第三方代表，例如，上
    级监管部门或银联组织建立，也可以由运营商联合共同建立。
    
				</td></tr><tr><td class="content" id="description_103">所应说明的是，图2a中只示出了两个运营商应用业务服务器，实际应
    用中，也可以包括三个或三个以上的运营商应用业务服务器。
    
				</td></tr><tr><td class="content" id="description_104">图2b为本发明CMA服务器结构示意图，参见图2b，该CMA服务器
    包括：认证注册模块、应用业务处理模块、应用业务存储模块、CA卡注册
    信息存储模块，其中，
    
				</td></tr><tr><td class="content" id="description_105">认证注册模块，用于根据来自UE的注册请求信息，根据包含的CA卡
    卡号，根据预先存储的认证密钥与该CA卡进行双向注册认证，注册认证通
    过后，通知应用业务处理模块，并将注册认证信息存储在CA卡注册信息存
    储模块；
    
				</td></tr><tr><td class="content" id="description_106">应用业务处理模块，用于接收认证注册模块发送的通知，从应用业务存
    储模块读取运营商应用业务服务器应用业务列表信息进行发送；
    
				</td></tr><tr><td class="content" id="description_107">接收来自UE的应用业务程序请求信息，查询CA卡注册信息存储模块，
    确认该UE对应的CA卡已通过注册认证，根据应用业务程序请求信息包含
    的运营商应用业务服务器ID信息，向相应运营商应用业务服务器发送；
    
				</td></tr><tr><td class="content" id="description_108">接收运营商服务器返回的应用业务程序请求响应信息，向UE发送，将
    应用业务程序请求响应信息包含的应用业务程序安装密钥和授权密钥信息
    发送至应用业务存储模块；
    
				</td></tr><tr><td class="content" id="description_109">应用业务存储模块，用于存储运营商应用业务服务器应用业务列表信
    息、应用业务程序安装密钥和授权密钥信息；
    
				</td></tr><tr><td class="content" id="description_110">CA卡注册信息存储模块，用于存储CA卡注册信息。
    
				</td></tr><tr><td class="content" id="description_111">实际应用中，应用业务存储模块存储的运营商应用业务服务器应用业务
    列表信息可以是以列表的形式存在，如表1所示。
    
				</td></tr><tr><td class="content" id="description_112">表1
    
				</td></tr><tr><td class="content" id="description_113">
					<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=810519584&amp;blobId=653785588" width="492"/>
					
				</td></tr><tr><td class="content" id="description_114">表1中，i、j、k为自然数，i可以等于j，即运营商应用业务服务器1
    和运营商应用业务服务器2可以提供相同的应用业务。
    
				</td></tr><tr><td class="content" id="description_115">也可以是运营商应用业务服务器在自身应用业务进行升级或更新授权
    密钥后，将相应信息通过专用网络通知CMA服务器，CMA服务器存储相
    关信息，在后续中运营商应用业务服务器发送应用业务程序请求响应信息
    时，可以不携带相关授权信息和安装密钥信息等信息，CMA服务器从相应
    的应用业务存储模块获取应用业务程序对应的安装密钥和授权密钥信息。应
    用业务存储模块存储的信息还可以如表2所示。
    
				</td></tr><tr><td class="content" id="description_116">表2
    
				</td></tr><tr><td class="content" id="description_117">
					<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=810519601&amp;blobId=653784543" width="492"/>
					
				</td></tr><tr><td class="content" id="description_118">
					<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=810519610&amp;blobId=655091342" width="492"/>
					
				</td></tr><tr><td class="content" id="description_119">表2中，i、j、k为自然数，i可以等于j，即运营商应用业务服务器1
    和运营商应用业务服务器2可以提供相同的应用业务，V<sub>10</sub>表示应用业务1
    的版本还没有进行过更新，V<sub>i2</sub>表示应用业务i的版本为第二次更新。
    
				</td></tr><tr><td class="content" id="description_120">图2c为本发明CA卡结构示意图，参见图2c，该CA卡包括应用管理
    模块、防火墙模块以及运营商安全域模块，其中，
    
				</td></tr><tr><td class="content" id="description_121">应用管理模块，用于接收UE发送的通知信息，根据预先存储的认证密
    钥完成与CMA服务器的注册认证并存储注册认证信息，接收UE发送的应
    用业务程序请求响应信息并存储，根据应用业务程序请求响应信息中包含的
    运营商应用业务服务器信息，建立运营商应用业务服务器与运营商安全域模
    块的映射关系，接收加密的应用业务程序，进行解密后安装该应用业务程序，
    并将应用业务程序存储在运营商安全域模块中；
    
				</td></tr><tr><td class="content" id="description_122">防火墙模块，用于隔离应用管理模块与运营商安全域模块、以及隔离各
    运营商安全域模块；
    
				</td></tr><tr><td class="content" id="description_123">运营商安全域模块，用于存储应用业务程序和应用数据。
    
				</td></tr><tr><td class="content" id="description_124">实际应用中，运营商安全域模块还用于存储后续中下载的应用业务信
    息，每个运营商应用业务服务器标识(ID，Identification)对应一个运营商
    安全域，每个应用业务对应一个应用业务ID，当更新或删除运营商安全域，
    或者应用业务时，相应的应用管理模块存储的信息也相应变化。
    
				</td></tr><tr><td class="content" id="description_125">本实施例中，多运营商的应用业务由统一的CMA服务器来维护和管理，
    从而使CA卡可以和多个运营商应用业务服务器交互，CA卡为每个运营商
    应用业务服务器提供独立的运营商安全域，可以使各个运营商应用业务服务
    器提供的应用业务相互隔离，用户通过选择运营商应用业务服务器ID以及
    其所提供的应用业务ID来激活所要使用的应用业务，进行相应的操作。
    
				</td></tr><tr><td class="content" id="description_126">图3为本发明基于条件接收卡实现多应用业务的注册认证应用业务流
    
					程示意图，本实施例中，运营商应用业务服务器为广电运营商应用业务服务
    器，参见图3，该流程包括：
    
				</td></tr><tr><td class="content" id="description_127">步骤301，UE检测到CA卡复位后，如果确定CA卡为首次使用，向
    CA卡发送初始化注册命令信息；
    
				</td></tr><tr><td class="content" id="description_128">本步骤中，通过UE上的软件检测CA卡是否复位。
    
				</td></tr><tr><td class="content" id="description_129">实际应用中，如果用户需要向新的运营商应用业务服务器进行注册认
    证，向CA卡发送注册命令信息，其处理流程与初始化注册命令信息处理流
    程相类似，在此不再赘述。
    
				</td></tr><tr><td class="content" id="description_130">步骤302，CA卡接收初始化注册命令信息，向UE返回初始化注册命
    令响应信息，携带注册相关信息；
    
				</td></tr><tr><td class="content" id="description_131">本步骤中，注册相关信息包括：CA卡卡号、CA卡初始密码、CA卡发
    卡日期等信息。注册相关信息存储在CA卡中的应用管理模块。
    
				</td></tr><tr><td class="content" id="description_132">步骤303，UE接收初始化注册命令响应信息，向CMA服务器发送注册
    请求信息；
    
				</td></tr><tr><td class="content" id="description_133">本步骤中，UE接收初始化注册命令响应信息，向CMA服务器发送注
    册请求信息，携带注册相关信息。
    
				</td></tr><tr><td class="content" id="description_134">步骤304，CMA服务器接收注册请求信息，通过UE向CA卡发送携带
    第一随机数的第一注册认证信息；
    
				</td></tr><tr><td class="content" id="description_135">本步骤中，CMA服务器接收注册请求信息，存储注册相关信息，产生
    一个第一随机数，用于与CA卡进行注册认证，并将该第一随机数携带在第
    一注册认证信息中，发送至UE，UE将接收的第一注册认证信息向CA卡发
    送。
    
				</td></tr><tr><td class="content" id="description_136">步骤305，CA卡接收第一注册认证信息，进行处理，通过UE向CMA
    服务器发送第一注册认证响应信息；
    
				</td></tr><tr><td class="content" id="description_137">本步骤中，CA卡接收第一注册认证信息，产生一个新的第二随机数，
    并利用存储的密钥文件中的CMA服务器公钥加密第一注册认证信息中的第
    一随机数，将加密的第一随机数和新产生的第二随机数携带在第一注册认证
    
					响应信息中，发送至UE，UE将接收的第一注册认证响应信息发送至CMA
    服务器。
    
				</td></tr><tr><td class="content" id="description_138">实际应用中，CA卡也可以在向UE返回的初始化注册命令响应信息中
    直接携带由CA卡产生的随机数。
    
				</td></tr><tr><td class="content" id="description_139">由CA卡中的应用管理模块对接收的第一注册认证信息进行存储和相应
    处理。
    
				</td></tr><tr><td class="content" id="description_140">步骤306，CMA服务器接收第一注册认证响应信息，进行处理，通过
    UE向UE发送第二注册认证信息；
    
				</td></tr><tr><td class="content" id="description_141">本步骤中，CMA服务器接收第一注册认证响应信息，获取其中包含的
    第二随机数和加密的第一随机数，利用自身的私钥解密加密的第一随机数，
    如果解密得到的随机数与自身发送至CA卡的第一随机数相同，则通过对
    CA卡的注册认证，然后用自身保存的对应该CA卡的公钥加密第二随机数，
    并将加密的第二随机数携带在第二注册认证信息中，发送至UE，UE将接收
    的第二注册认证信息发送至CA卡。
    
				</td></tr><tr><td class="content" id="description_142">实际应用中，如果CMA服务器解密得到的随机数与自身发送至CA卡
    的第一随机数不相同，则向CA卡返回包含注册认证失败的第二注册认证信
    息，并结束流程。
    
				</td></tr><tr><td class="content" id="description_143">步骤307，CA卡接收第二注册认证信息，进行处理，通过UE向CMA
    服务器发送第二注册认证响应信息；
    
				</td></tr><tr><td class="content" id="description_144">本步骤中，CA卡接收第二注册认证信息，获取加密的第二随机数，利
    用自身存储的私钥解密加密的第二随机数，如果解密得到的随机数与自身发
    送至CMA服务器的第二随机数相同，则通过对CMA服务器的注册认证，
    向CMA服务器返回携带第二注册认证成功的第二注册认证响应信息；如果
    解密得到的随机数与自身发送至CMA服务器的第二随机数不相同，向CMA
    服务器返回携带第二注册认证失败的第二注册认证响应信息，并结束该流
    程。
    
				</td></tr><tr><td class="content" id="description_145">同样地，由CA卡中的应用管理模块对接收的第二注册认证信息进行存
    
					储和相应处理。
    
				</td></tr><tr><td class="content" id="description_146">步骤308，CMA服务器接收第二注册认证响应信息，确定包含第二注
    册认证成功信息，将预先存储的运营商应用业务服务器应用业务列表信息发
    送至UE；
    
				</td></tr><tr><td class="content" id="description_147">本步骤中，CMA服务器存储第二注册认证响应信息中的相关信息，如
    CA卡的注册认证状态信息，运营商应用业务服务器应用业务列表信息包含：
    运营商应用业务服务器标识(ID，Identification)、该运营商应用业务服务
    器ID对应的应用业务，一个运营商应用业务服务器ID可以对应多个应用业
    务，各不同运营商应用业务服务器也可以提供相同的应用业务。
    
				</td></tr><tr><td class="content" id="description_148">运营商应用业务服务器应用业务列表信息也可以包含：运营商应用业务
    服务器列表信息和运营商应用业务服务器对应的应用业务列表信息。
    
				</td></tr><tr><td class="content" id="description_149">CMA服务器可以是预先通过与运营商应用业务服务器的交互，获取各
    运营商可以提供的应用业务，生成运营商应用业务服务器应用业务列表信息
    并存储。
    
				</td></tr><tr><td class="content" id="description_150">实际应用中，CMA服务器可能同时与多个CA卡执行注册认证，对于
    注册认证通过的CA卡，CMA服务器将预先存储的运营商应用业务服务器
    应用业务列表信息通过相应的UE发送至CA卡。
    
				</td></tr><tr><td class="content" id="description_151">步骤309，UE接收运营商应用业务服务器应用业务列表信息，根据用
    户的选择，向CMA服务器发送应用业务程序请求信息；
    
				</td></tr><tr><td class="content" id="description_152">本步骤中，UE接收运营商应用业务服务器应用业务列表信息，由用户
    从运营商应用业务服务器应用业务列表信息中选择自身需要的运营商应用
    业务，UE根据用户的选择，向CMA服务器发送应用业务程序请求信息，
    包含运营商应用业务以及该应用业务对应的运营商应用业务服务器ID、CA
    卡卡号等信息。
    
				</td></tr><tr><td class="content" id="description_153">实际应用中，UE将用户从各运营商应用业务服务器应用业务列表信息
    中选择的各运营商应用业务，即各运营商应用业务服务器ID、以及对应的
    应用业务ID列表信息发送至CA卡的应用管理模块进行存储。
    
				</td></tr><tr><td class="content" id="description_154">步骤310，CMA服务器接收应用业务程序请求信息，查询确定CA卡已
    注册认证，将接收的应用业务程序请求信息发送至相应的运营商应用业务服
    务器；
    
				</td></tr><tr><td class="content" id="description_155">本步骤中，CMA服务器接收应用业务程序请求信息，根据应用业务程
    序请求信息包含的CA卡卡号确定该CA卡是否已注册认证，如果已通过注
    册认证，再根据应用业务程序请求信息包含的运营商应用业务服务器ID信
    息，将接收的应用业务程序请求信息发送至相应的运营商应用业务服务器；
    如果确定该CA卡还没有进行注册认证，执行如前所述的与CA卡的注册认
    证流程。
    
				</td></tr><tr><td class="content" id="description_156">步骤311，运营商应用业务服务器接收应用业务程序请求信息，向CMA
    服务器返回应用业务程序请求响应信息，并通过业务通道下发该应用业务程
    序；
    
				</td></tr><tr><td class="content" id="description_157">本步骤中，运营商应用业务服务器接收应用业务程序请求信息，保存应
    用业务程序请求信息中的CA卡卡号以及用户选择的应用业务程序请求信
    息，向CMA服务器返回应用业务程序请求响应信息，包含用户请求的运营
    商应用业务程序的大小、安装密钥和授权密钥信息等信息。
    
				</td></tr><tr><td class="content" id="description_158">运营商应用业务服务器的每个应用业务程序对应一个授权密钥，可以是
    以列表的形式存在，例如，每个应用业务程序ID对应一个授权密钥；安装
    密钥为每个应用业务程序在安装过程中对应的密钥。
    
				</td></tr><tr><td class="content" id="description_159">运营商应用业务服务器在向CMA服务器返回应用业务程序请求响应信
    息后，将该用户请求的应用业务程序利用授权密钥加密，通过业务通道下发
    至该应用业务程序对应的UE。
    
				</td></tr><tr><td class="content" id="description_160">步骤312，CMA服务器接收应用业务程序请求响应信息并发送至UE；
    
				</td></tr><tr><td class="content" id="description_161">步骤313，UE将接收的应用业务程序请求响应信息及应用业务程序发
    送至CA卡；
    
				</td></tr><tr><td class="content" id="description_162">本步骤中，UE从非业务通道接收应用业务程序请求响应信息；从业务
    通道接收加密的应用业务程序，与CA卡进行认证，认证通过后再将接收的
    
					应用业务程序请求响应信息及加密的应用业务程序发送至CA卡。
    
				</td></tr><tr><td class="content" id="description_163">实际应用中，也可以由UE对加密的应用业务程序进行解密，即在本步
    骤中，UE接收应用业务程序请求响应信息和加密的应用业务程序，利用应
    用业务程序请求响应信息中包含的授权密钥对从业务通道接收的加密的应
    用业务程序进行解密，再与CA卡进行认证，认证通过后再将解密的应用业
    务程序发送至CA卡。
    
				</td></tr><tr><td class="content" id="description_164">步骤314，CA卡接收，利用应用业务程序请求响应信息包含的授权密
    钥对加密的应用业务程序进行解密，并利用应用安装密钥进行应用安装。
    
				</td></tr><tr><td class="content" id="description_165">本步骤中，CA卡接收应用业务程序请求响应信息，利用其包含的授权
    密钥对加密的应用业务程序进行解密，在CA卡应用管理模块中存储运营商
    应用对应的应用安装密钥和授权密钥信息；为各运营商应用业务服务器分配
    相应的运营商安全域空间，每个运营商应用业务服务器对应相应的运营商安
    全域ID，各运营商安全域通过防火墙相互隔离，每个运营商安全域ID内又
    分配若干应用业务ID，以用于后续对应的业务信息存储。利用获取的应用
    安装密钥进行应用安装。
    
				</td></tr><tr><td class="content" id="description_166">至此，该注册认证流程结束。
    
				</td></tr><tr><td class="content" id="description_167">本实施例中，CMA服务器预先存储有运营商应用业务服务器列表信息
    和每个运营商应用业务服务器的可用业务列表信息，在CA卡注册认证时，
    使用非业务通道与CMA服务器执行双向认证流程，认证通过后，CMA服
    务器将预先存储的运营商应用业务服务器列表信息和每个运营商应用业务
    服务器的可用业务列表信息下发到UE，用户根据个人的需求选择相应运营
    商应用业务服务器的应用业务服务，运营商应用业务服务器根据用户通过
    CMA服务器发送的反馈信息，将用户请求的运营商应用业务程序安装密钥
    和授权密钥通过CMA服务器发送至UE，并通过业务通道下发对应的经授
    权密钥加密的应用业务程序，UE接收后发送至CA卡，CA卡利用授权密钥
    对接收的加密的应用业务程序解密，并利用安装密钥进行安装，实现了CA
    卡支持多运营商的应用业务的目的，满足用户多样化业务和高质量服务的需
    
					求。
    
				</td></tr><tr><td class="content" id="description_168">后续中，运营商应用业务服务器可以主动、也可以根据用户的请求，将
    应用业务信息加扰后通过运营商应用业务服务器自身经营的业务通道，如广
    播通信网络下发到UE，UE接收后发送至CA卡，CA卡利用存储的解扰密
    钥进行解扰，将解扰的应用业务信息存储在相应运营商安全域的相应应用业
    务模块中。
    
				</td></tr><tr><td class="content" id="description_169">实际应用中，CA卡中安装的应用业务程序可能需要进行更新，例如，
    根据用户的需求或运营商的考虑，对安装的应用业务程序进行升级、删除，
    或者，安装新的应用业务程序等，以实现CA卡的动态更新。
    
				</td></tr><tr><td class="content" id="description_170">应用业务程序更新包括批量应用业务程序更新和定制应用业务程序更
    新，批量应用业务程序更新应用在运营商应用业务服务器需要对大量CA卡
    统一更新应用业务程序的环境，例如，运营商发布新的应用业务服务和对原
    有应用业务服务进行升级；定制应用业务程序更新应用在用户通过触发选择
    来更新本机CA卡的应用业务程序的环境，例如，用户通过CMA服务器要
    求运营商应用业务服务器对单张CA卡定制的应用业务程序进行更新。
    
				</td></tr><tr><td class="content" id="description_171">图4为本发明基于条件接收卡实现多应用业务的批量应用业务程序更
    新流程示意图，参见图4，该流程包括：
    
				</td></tr><tr><td class="content" id="description_172">步骤401，运营商应用业务服务器通过专用网络向CMA服务器发送批
    量更新应用业务程序请求信息；
    
				</td></tr><tr><td class="content" id="description_173">本步骤中，批量更新应用业务程序请求信息包括：运营商应用业务服务
    器ID、更新的应用业务程序ID列表、该应用业务程序对应的加扰密钥、更
    新应用业务程序的大小等信息。
    
				</td></tr><tr><td class="content" id="description_174">实际应用中，批量更新应用业务程序请求信息也可以不包括应用业务程
    序对应的加扰密钥信息。
    
				</td></tr><tr><td class="content" id="description_175">步骤402，CMA服务器接收并通过非业务通道向UE发送批量更新应用
    业务程序请求信息；
    
				</td></tr><tr><td class="content" id="description_176">本步骤中，CMA服务器接收运营商应用业务服务器发送的批量更新应
    
					用业务程序请求信息，存储相关信息，根据存储的该运营商应用业务服务器
    认证的UE信息，将接收的批量更新应用业务程序请求信息向存储的所有的
    该运营商应用业务服务器认证的UE发送。
    
				</td></tr><tr><td class="content" id="description_177">实际应用中，CMA服务器也可以将接收的批量更新应用业务程序请求
    信息向所有UE发送。
    
				</td></tr><tr><td class="content" id="description_178">如果应用业务程序对应的授权密钥已经进行了更新，则CMA服务器还
    需要将该应用业务程序对应的更新的授权密钥信息携带在批量更新应用业
    务程序请求信息中。CMA服务器按照预先的设定与运营商应用业务服务器
    交互获取更新的授权密钥信息并存储。
    
				</td></tr><tr><td class="content" id="description_179">步骤403，UE接收批量更新应用业务程序请求信息，经过滤处理后发
    送至CA卡；
    
				</td></tr><tr><td class="content" id="description_180">本步骤中，UE接收批量更新应用业务程序请求信息，由用户选择需要
    更新的应用业务程序，UE将用户过滤处理后的批量更新应用业务程序请求
    信息发送至CA卡，包含选择的应用业务程序ID号列表及对应的运营商应
    用业务服务器ID号、选择的应用业务程序对应的加扰密钥、选择的更新应
    用业务程序的大小等信息。
    
				</td></tr><tr><td class="content" id="description_181">实际应用中，UE也可以根据用户预先设置的默认设置对接收的批量更
    新应用业务程序请求信息进行过滤后发送至CA卡。
    
				</td></tr><tr><td class="content" id="description_182">步骤404，CA卡接收过滤后的批量更新应用业务程序请求信息，向UE
    返回批量更新应用业务请求响应信息；
    
				</td></tr><tr><td class="content" id="description_183">本步骤中，CA卡接收批量更新应用业务程序请求信息，查询运营商应
    用业务服务器ID号是否与自身应用管理模块存储的运营商应用业务服务器
    ID号一致，对应的应用业务程序是否存在，以及对应的该运营商安全域存
    储空间是否满足，如果上述三个条件都满足，或者，如果是对应的该运营商
    安全域存储空间不满足，则还可以根据用户默认的设置或与用户交互，删除
    其它应用业务程序以增大剩余的存储空间，如果删除其它应用业务程序后的
    存储空间足够，存储接收信息中包含的需要更新的应用业务程序对应的加扰
    
					密钥，向UE返回批量更新应用业务请求响应信息，包含自身需要更新的应
    用业务程序ID号列表信息；如果不满足，向UE发送包含拒绝信息的批量
    更新应用业务请求响应信息。
    
				</td></tr><tr><td class="content" id="description_184">当然，实际应用中，也可以在对应的该运营商安全域存储空间满足的条
    件下，如果CA卡未安装有该应用业务程序，则询问用户是否需要安装该应
    用业务程序，如果是，向UE发送批量更新应用业务请求响应信息，包含自
    身需要更新的应用业务程序ID号列表信息以及表明该应用业务程序是需要
    更新还是需要安装的信息。
    
				</td></tr><tr><td class="content" id="description_185">步骤405，UE接收批量更新应用业务程序请求响应信息并向CMA服务
    器发送；
    
				</td></tr><tr><td class="content" id="description_186">步骤406，CMA服务器接收批量更新应用业务程序请求响应信息，获
    取更新应用业务程序对应的授权密钥和安装密钥；
    
				</td></tr><tr><td class="content" id="description_187">本步骤中，CMA服务器还可以记录该批量更新应用业务程序请求响应
    信息。例如，记录每张CA卡的更新状态信息，当接收到CA卡发送的更新
    完成信息，通知运营商应用业务服务器停止发送更新应用业务程序。
    
				</td></tr><tr><td class="content" id="description_188">CMA服务器根据接收的批量更新应用业务程序请求响应信息中包含的
    用户确定的需要更新应用业务程序，从存储的信息中获取该更新应用业务程
    序对应的授权密钥和安装密钥。
    
				</td></tr><tr><td class="content" id="description_189">步骤407，运营商应用业务服务器通过业务通道向UE发送加密的应用
    业务对应的应用业务程序；
    
				</td></tr><tr><td class="content" id="description_190">本步骤也可以是在执行步骤401后进行，运营商应用业务服务器将需要
    更新的应用业务程序利用加扰密钥、和/或，授权密钥加密后通过业务通道
    向所有的UE发送。
    
				</td></tr><tr><td class="content" id="description_191">实际应用中，运营商应用业务服务器也可以通过空中接口(OTA，Over
    the Air)，即通过非业务通道，例如，移动通信网络、互联网络向UE发
    送需要更新的应用业务程序。
    
				</td></tr><tr><td class="content" id="description_192">如果运营商应用业务服务器预先没有发送加扰密钥，则将该应用业务程
    
					序用相应的授权密钥加密后发送。
    
				</td></tr><tr><td class="content" id="description_193">步骤408，UE从业务通道接收加密的应用业务程序；从非业务通道接
    收授权密钥和安装密钥，处理后发送至CA卡；
    
				</td></tr><tr><td class="content" id="description_194">本步骤中，如果运营商应用业务服务器从OTA发送加密的应用业务程
    序，则UE从相应的OTA接收加密的应用业务程序。
    
				</td></tr><tr><td class="content" id="description_195">UE从非业务通道接收授权密钥和安装密钥，然后与CA卡进行认证，
    认证通过后将授权密钥和安装密钥以及用户选择的需要更新的应用业务程
    序发送至CA卡。
    
				</td></tr><tr><td class="content" id="description_196">步骤409，CA卡接收加密的应用业务程序，利用授权密钥和安装密钥
    对加密的应用业务程序进行解密，并安装该解密后的应用业务程序。
    
				</td></tr><tr><td class="content" id="description_197">本步骤中，CA卡的应用管理模块接收加密的的应用业务程序，利用授
    权密钥和安装密钥对加密的应用业务程序进行解密，更新已安装的应用业务
    程序，并在安装更新完成后，可以通过CMA服务器向相应的运营商应用业
    务服务器发送通知信息，运营商应用业务服务器接收通知信息，停止向CA
    卡发该应用业务程序。
    
				</td></tr><tr><td class="content" id="description_198">实际应用中，用户还可以通过定制的方式对应用业务程序进行更新。对
    于用户定制的应用业务程序更新，UE可以通过业务信道接收定制的应用业
    务程序，然后通过非业务信道与CMA服务器进行认证获取授权密钥，解密
    定制的应用业务程序。应用业务程序解密之后，根据解密得到的应用业务程
    序的标识号来选择需要更新的运营商安全域，接下来，UE与CA卡进行双
    向认证，认证通过后，CA卡下载应用业务程序，并更新应用管理模块中相
    应的应用表单。
    
				</td></tr><tr><td class="content" id="description_199">图5为本发明基于条件接收卡实现多应用业务的定制应用业务程序更
    新流程示意图，参见图5，该流程包括：
    
				</td></tr><tr><td class="content" id="description_200">步骤501，运营商应用业务服务器确定CA卡定制的应用业务程序需要
    更新，通过专用网络向CMA服务器发送更新定制应用业务请求信息；
    
				</td></tr><tr><td class="content" id="description_201">本步骤中，可以是用户需要更新CA卡定制的应用业务程序时，通过
    
					CMA服务器向运营商应用业务服务器发送更新定制应用业务程序请求信
    息；也可以是运营商应用业务服务器根据自身存储的相关CA卡定制的应用
    业务信息，在该应用业务程序升级后，向CMA服务器发送更新定制应用业
    务程序请求信息；还可以是运营商应用业务服务器在自身应用业务程序升级
    后，向CMA服务器发送更新定制应用业务程序请求，CMA服务器根据自
    身存储的相关CA卡定制的应用业务信息，确定该CA卡定制的对应的应用
    业务程序，生成更新定制应用业务程序请求信息。
    
				</td></tr><tr><td class="content" id="description_202">更新定制应用业务请求信息包括：该CA卡定制的应用业务程序ID号
    列表和应用业务程序对应的运营商应用业务服务器标识(ID，Identification)
    号、各应用业务程序对应的授权密钥、加扰密钥、安装应用业务程序所需空
    间大小等信息。
    
				</td></tr><tr><td class="content" id="description_203">步骤502，CMA服务器接收并通过非业务通道向UE发送更新定制应用
    业务程序请求信息；
    
				</td></tr><tr><td class="content" id="description_204">本步骤中，CMA服务器接收更新定制应用业务程序请求信息，存储相
    关信息，根据包含的CA卡卡号信息，通过非业务通道向相应的UE发送更
    新定制应用业务程序请求信息。
    
				</td></tr><tr><td class="content" id="description_205">步骤503，UE接收更新定制应用业务程序请求信息，向CA卡发送；
    
				</td></tr><tr><td class="content" id="description_206">本步骤中，UE接收更新定制应用业务程序请求信息并存储，也可以选
    择需要的定制应用业务程序，携带在更新定制应用业务程序请求信息中，发
    送至CA卡。
    
				</td></tr><tr><td class="content" id="description_207">步骤504，CA卡接收更新定制应用业务程序请求信息，向UE返回更
    新定制应用业务程序请求响应信息；
    
				</td></tr><tr><td class="content" id="description_208">本步骤中，CA卡接收更新定制应用业务程序请求信息，存储相关信息，
    查询对应的该运营商安全域存储空间是否满足，如果满足，向UE发送更新
    定制应用业务程序请求响应信息，携带确认信息；如果不满足，向UE发送
    更新定制应用业务程序请求响应信息，携带拒绝信息，并结束流程。
    
				</td></tr><tr><td class="content" id="description_209">步骤505，UE接收更新定制应用业务程序请求响应信息并向CMA服务
    
					器发送；
    
				</td></tr><tr><td class="content" id="description_210">步骤506，CMA服务器接收更新定制应用业务程序请求响应信息并向
    运营商应用业务服务器发送；
    
				</td></tr><tr><td class="content" id="description_211">本步骤中，CMA服务器还可以记录更新定制应用业务程序请求响应信
    息。根据更新定制应用业务程序请求响应信息中的运营商应用业务服务器ID
    号，将该更新定制应用业务程序请求响应信息发送至对应的运营商应用业务
    服务器。
    
				</td></tr><tr><td class="content" id="description_212">步骤507，运营商应用业务服务器接收更新定制应用业务程序请求响应
    信息，通过业务通道向相应的UE发送用户定制的应用业务更新程序；
    
				</td></tr><tr><td class="content" id="description_213">本步骤中，运营商应用业务服务器接收更新定制应用业务程序请求响应
    信息，根据更新定制应用业务程序请求响应信息中携带的确认信息，将用户
    定制的应用业务更新程序利用加扰密钥，和/或，授权密钥加密后通过业务
    通道向对应的UE发送。
    
				</td></tr><tr><td class="content" id="description_214">实际应用中，运营商应用业务服务器也可以通过空中接口(OTA，Over
    the Air)向相应的UE发送加密的应用业务更新程序。
    
				</td></tr><tr><td class="content" id="description_215">步骤508，UE从业务通道接收加密的应用业务更新程序，获取应用业
    务更新程序包含的运营商应用业务服务器ID号，向CA卡的应用管理模块
    发送第三随机数；
    
				</td></tr><tr><td class="content" id="description_216">本步骤中，如果运营商应用业务服务器从OTA发送应用程序，则UE
    从相应的OTA接收加密的应用程序。
    
				</td></tr><tr><td class="content" id="description_217">在接收到加密的应用业务更新程序后，通过非业务信道与CMA服务器
    进行认证获取授权密钥，利用授权密钥以及自身存储的加扰密钥解密定制的
    应用业务更新程序，获取应用业务更新程序包含的运营商应用业务服务器ID
    号，向CA卡的应用管理模块发送第三随机数。
    
				</td></tr><tr><td class="content" id="description_218">实际应用中，UE从业务通道接收到加密的应用业务更新程序后，也可
    以直接发送至CA卡，CA卡根据存储的加扰密钥以及授权密钥进行解密，
    获取应用业务更新程序，并进行更新安装。
    
				</td></tr><tr><td class="content" id="description_219">本实施例中，UE与CA卡进行相互认证是为了进一步提高UE与CA
    卡通信的安全性，其相互认证流程和CA卡与CMA服务器相互之间的认证
    流程相类似。
    
				</td></tr><tr><td class="content" id="description_220">步骤509，CA卡的应用管理模块接收第三随机数，利用密钥文件中存
    储的UE公钥加密第三随机数并产生一个新的第四随机数，把加密的第三随
    机数和新产生的第四随机数发送至UE；
    
				</td></tr><tr><td class="content" id="description_221">步骤510，UE接收CA卡的应用管理模块发送的加密的第三随机数和
    新产生的第四随机数，利用自身的私钥解密加密的第三随机数，如果解密后
    的随机数与自身发送给CA卡的应用管理模块的第三随机数相同，表明UE
    对CA卡的应用管理模块的认证通过；然后，利用自身存储的对应CA卡的
    公钥加密第四随机数，并将该加密的第四随机数发送给CA卡的应用管理模
    块；
    
				</td></tr><tr><td class="content" id="description_222">步骤511，CA卡的应用管理模块接收加密的第四随机数，利用自己的
    私钥解密加密的第四随机数并与自身产生的第四随机数进行比对，如果相
    同，则表明CA卡的应用管理模块对UE的认证通过，向UE返回认证响应
    信息；
    
				</td></tr><tr><td class="content" id="description_223">步骤512，UE接收认证响应信息，向CA卡的应用管理模块发送应用
    业务更新程序；
    
				</td></tr><tr><td class="content" id="description_224">本步骤中，向CA卡的应用管理模块发送的是加密的应用业务更新程序。
    
				</td></tr><tr><td class="content" id="description_225">步骤513，CA卡的应用管理模块接收应用业务更新程序并进行相应的
    解密，更新自身存储的相应信息，并安装该解密的应用业务更新程序。
    
				</td></tr><tr><td class="content" id="description_226">实际应用中，用户可能根据自身需要，在CA卡提供的多个应用业务中
    进行切换，UE通过访问应用管理模块来查看用户定制的应用业务列表，并
    分别验证UE对相应运营商安全域的访问权限、以及运营商安全域中应用业
    务的访问权限，如果验证通过，进行应用业务切换。
    
				</td></tr><tr><td class="content" id="description_227">图6为本发明CA卡中应用业务切换流程示意图，参见图6，该流程包
    括：
    
				</td></tr><tr><td class="content" id="description_228">步骤601，UE接收切换请求，向应用管理模块发送包含运营商应用业
    务服务器ID号以及用户识别号(PIN，Personal Identify Number)码的应用
    协议数据单元(APDU，Application Protocol Data Unit)的第一访问权限请
    求信息；
    
				</td></tr><tr><td class="content" id="description_229">本步骤中，UE接收切换请求，获取切换请求对应的运营商应用业务服
    务器ID号，向应用管理模块发送第一访问权限请求信息，用以验证UE对
    该运营商应用业务服务器ID号对应的运营商安全域的访问权限。
    
				</td></tr><tr><td class="content" id="description_230">第一访问权限请求信息包含运营商应用业务服务器ID号以及PIN码的
    APDU信息。
    
				</td></tr><tr><td class="content" id="description_231">步骤602，应用管理模块接收第一访问权限请求信息，验证PIN码，如
    果确定验证通过，向UE返回第一访问权限请求成功信息；
    
				</td></tr><tr><td class="content" id="description_232">本步骤中，应用管理模块接收第一访问权限请求信息，保存当前应用业
    务的上下文信息，根据存储的信息验证第一访问权限请求信息中包含的PIN
    码，具体的验证流程为现有技术，在此不再赘述，如果确定验证通过，向
    UE返回第一访问权限请求成功信息。
    
				</td></tr><tr><td class="content" id="description_233">步骤603，UE接收第一访问权限请求成功信息，向应用管理模块发送
    包含应用标识符(AID，Application Identifier)和二级PIN码的第二访问权
    限请求信息；
    
				</td></tr><tr><td class="content" id="description_234">本步骤中，UE接收第一访问权限请求成功信息，向应用管理模块发送
    包含应用业务标识符(AID，Application Identifier)和二级PIN码的第二访
    问权限请求信息，用以验证对该运营商安全域中应用业务的访问权限，二级
    PIN码对应运营商安全域中应用业务标识。
    
				</td></tr><tr><td class="content" id="description_235">步骤604，应用管理模块接收第二访问权限请求信息，验证二级PIN码，
    如果验证通过，向UE返回第二访问权限请求成功信息；
    
				</td></tr><tr><td class="content" id="description_236">步骤605，应用管理模块查询该切换的应用业务所在运营商安全域的地
    址，建立与UE的通道；
    
				</td></tr><tr><td class="content" id="description_237">步骤606，UE切换应用业务。
    
				</td></tr><tr><td class="content" id="description_238">本步骤中，UE切换应用业务，通过切换建立的通道访问运营商安全域
    中应用业务模块，进行应用业务数据更新和查看。
    
				</td></tr><tr><td class="content" id="description_239">实际应用中，对于多应用业务的切换，可以有多种切换处理方式。例如，
    CA卡的操作系统(OS，Operation System)同时将多个应用业务的上下文信
    息，即应用业务的资源分配信息保存在应用管理模块中。应用业务的集合形
    成一个应用业务池，OS选择应用业务池中默认的应用业务作为起始应用业
    务开始执行，当有其他应用业务启动请求时，OS保存当前执行的应用业务
    上下文信息，然后从应用管理模块中取出请求对应的应用业务上下文，执行
    该应用业务。当运营商安全域中的存储资源不足时，应用管理模块根据预先
    设定的规则保留满足规则的应用业务执行，并通知其它不满足规则的应用业
    务，由于应用业务忙而不能执行。
    
				</td></tr><tr><td class="content" id="description_240">多应用业务的切换处理包括：基于中断模式的多应用业务切换处理、基
    于时间片模式的多应用业务交叉切换处理以及基于混合模式的多应用业务
    切换处理。
    
				</td></tr><tr><td class="content" id="description_241">图7为本发明基于中断模式的多应用业务切换处理流程示意图，参见图
    7，以三个应用业务为例，该流程包括：
    
				</td></tr><tr><td class="content" id="description_242">步骤701，CA卡应用管理模块选择应用业务池中默认的应用业务1作
    为起始应用业务开始执行；
    
				</td></tr><tr><td class="content" id="description_243">步骤702，UE接收用户要求切换至应用业务2请求，与应用管理模块
    进行认证；
    
				</td></tr><tr><td class="content" id="description_244">实际应用中，如果应用业务1与应用业务2属于同一运营商安全域，则
    UE与应用管理模块只需执行运营商安全域中应用业务访问权限的验证，向
    应用管理模块发送认证请求。
    
				</td></tr><tr><td class="content" id="description_245">步骤703，应用管理模块保存应用业务1上下文信息，与UE进行认证，
    认证通过后为应用业务2分配资源；
    
				</td></tr><tr><td class="content" id="description_246">实际应用中，应用管理模块接收认证请求，如果应用业务1与应用业务
    2属于同一运营商安全域，则与UE执行运营商安全域中应用业务访问权限
    
					的验证，认证通过后利用为应用业务1分配的资源执行应用业务2；如果应
    用业务1与应用业务2不属于同一运营商安全域，则与UE执行运营商安全
    域的访问权限的验证、以及运营商安全域中应用业务访问权限的验证，认证
    通过后为应用业务2分配资源。
    
				</td></tr><tr><td class="content" id="description_247">步骤704，应用管理模块根据为应用业务2分配的资源执行应用业务2；
    
				</td></tr><tr><td class="content" id="description_248">步骤705，UE接收用户要求切换至应用业务3请求，与应用管理模块
    进行认证；
    
				</td></tr><tr><td class="content" id="description_249">步骤706，应用管理模块保存应用业务2上下文信息，与UE进行认证，
    认证通过后为应用业务3分配资源；
    
				</td></tr><tr><td class="content" id="description_250">步骤707，应用管理模块根据为应用业务3分配的资源执行应用业务3；
    
				</td></tr><tr><td class="content" id="description_251">步骤708，应用业务3运行完毕，应用管理模块读取应用业务2上下文
    信息，执行应用业务2；
    
				</td></tr><tr><td class="content" id="description_252">步骤709，应用业务2运行完毕，应用管理模块读取应用业务1上下文
    信息，执行应用业务1。
    
				</td></tr><tr><td class="content" id="description_253">图8为本发明基于时间片模式的多业务交叉切换处理流程示意图，以应
    用业务1、应用业务2、应用业务3属于同一运营商安全域为例，参见图8，
    该流程包括：
    
				</td></tr><tr><td class="content" id="description_254">步骤801，CA卡应用管理模块确定需要执行三个应用业务，为每一应
    用业务分配时间片，执行应用业务1；
    
				</td></tr><tr><td class="content" id="description_255">本步骤中，CA卡需要并行执行应用业务1、应用业务2、应用业务3
    三个应用业务，应用管理模块为三个应用业务分配时间片，即时间片1对应
    应用业务1，时间片2对应应用业务2，时间片3对应应用业务3，分配的
    时间片长度可以根据应用业务而有所不同，在分配的时间片1时间内，执行
    应用业务1。
    
				</td></tr><tr><td class="content" id="description_256">步骤802，时间片1时间到，应用管理模块存储应用业务1上下文信息，
    执行应用业务2；
    
				</td></tr><tr><td class="content" id="description_257">步骤803，时间片2时间到，应用管理模块存储应用业务2上下文信息，
    
					执行应用业务3；
    
				</td></tr><tr><td class="content" id="description_258">本步骤中，应用管理模块中存储有应用业务1上下文信息和应用业务2
    上下文信息。
    
				</td></tr><tr><td class="content" id="description_259">步骤804，时间片3时间到，应用管理模块存储应用业务3上下文信息，
    执行应用业务1。
    
				</td></tr><tr><td class="content" id="description_260">本步骤中，在相应时间片时间到时，如果确定相应下一时间片对应的应
    用业务没有执行完，则执行相应的应用业务，直至所有的应用业务都执行完
    毕，然后结束流程。
    
				</td></tr><tr><td class="content" id="description_261">图9为本发明基于混合模式的多应用业务切换处理流程示意图，参见图
    9，该流程包括：
    
				</td></tr><tr><td class="content" id="description_262">步骤901，CA卡应用管理模块确定需要执行的应用业务，执行需要执
    行的应用业务的公共应用业务；
    
				</td></tr><tr><td class="content" id="description_263">本步骤中，CA卡应用管理模块确定需要执行的应用业务，从所有需要
    执行的应用业务中抽象出背景应用业务，即所有需要执行的应用业务的公共
    应用业务，并执行该公共应用业务。
    
				</td></tr><tr><td class="content" id="description_264">步骤902，公共应用业务执行完毕，存储公共应用业务上下文信息，以
    中断方式或时间片方式执行其他应用业务。
    
				</td></tr><tr><td class="content" id="description_265">本步骤中，以中断方式或时间片方式执行其他应用业务，即需要执行的
    应用业务除公共应用业务外的部分，与图7和图8所示流程相类似，在此不
    再赘述。
    
				</td></tr><tr><td class="content" id="description_266">由上述实施例可见，本发明提供的一种基于条件接收卡实现多应用业务
    的方法、系统及装置，通过多运营商共同组建、或者，由多运营商信任的第
    三方代表，如上级监管部门或银联组织组建CMA服务器，CMA服务器通
    过专用网络与各运营商应用业务服务器交互获取运营商应用业务服务器列
    表信息和每个运营商应用业务服务器的可用业务列表信息，并进行存储，在
    与CA卡双向注册认证通过后，将预先存储的运营商应用业务服务器列表信
    息和每个运营商应用业务服务器的可用业务列表信息通过非业务通道下发
    
					到UE，并将用户的反馈通知相应的运营商应用业务服务器，运营商应用业
    务服务器将用户请求的运营商应用业务程序安装密钥和授权密钥通过CMA
    服务器发送至UE，并通过业务通道下发对应的经授权密钥加密的应用业务
    程序，UE接收并发送至CA卡，CA卡利用授权密钥对接收的加密的应用业
    务程序解密，并利用安装密钥进行安装。实现了CA卡支持多运营商的应用
    业务的目的，满足用户多样化业务和高质量服务的需求；进一步地，利用业
    务信道传输广电运营商应用业务程序，可以提高管理的便捷性、灵活性和实
    时性，同时，可以避免现有中通过非业务通道下发应用业务程序时，由于占
    用移动通信网络无线资源而需支付给移动通信服务运营商的费用，节省了通
    信成本；而且，各运营商应用业务服务器可以根据应用业务的扩展或用户请
    求，通过CMA服务器对CA卡中各应用业务进行动态更新及升级，CA卡
    的功能更大强大，方便了用户的应用，避免了运营商应用业务服务器重新发
    放CA卡的成本，有利于运营商应用业务的扩展。
    
				</td></tr><tr><td class="content" id="description_267">以上举较佳实施例，对本发明的目的、技术方案和优点进行了进一步详
    细说明，所应理解的是，以上所述仅为本发明的较佳实施例而已，并不用以
    限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、
    改进等，均应包含在本发明的保护范围之内。
    
				</td></tr></table></div></body></html>